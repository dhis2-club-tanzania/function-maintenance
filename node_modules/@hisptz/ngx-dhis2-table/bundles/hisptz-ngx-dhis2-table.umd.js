(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('@hisptz/ngx-dhis2-table', ['exports', '@angular/core', '@angular/common'], factory) :
    (factory((global.hisptz = global.hisptz || {}, global.hisptz['ngx-dhis2-table'] = {}),global.ng.core,global.ng.common));
}(this, (function (exports,core,common) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * @param {?} favoriteObject
     * @param {?} visualizationLayout
     * @param {?} type
     * @return {?}
     */
    function getTableConfiguration(favoriteObject, visualizationLayout, type) {
        return {
            title: favoriteObject.hasOwnProperty('displayName')
                ? favoriteObject.displayName
                : favoriteObject.hasOwnProperty('name')
                    ? favoriteObject.name
                    : '',
            subtitle: favoriteObject.hasOwnProperty('subtitle')
                ? favoriteObject.subtitle
                : '',
            showColumnTotal: favoriteObject.hasOwnProperty('colTotal')
                ? favoriteObject.colTotal
                : true,
            showColumnSubtotal: favoriteObject.hasOwnProperty('colSubtotal')
                ? favoriteObject.colSubtotal
                : true,
            showRowTotal: favoriteObject.hasOwnProperty('rowTotal')
                ? favoriteObject.rowTotal
                : true,
            showRowSubtotal: favoriteObject.hasOwnProperty('rowSubtotal')
                ? favoriteObject.rowSubtotal
                : true,
            showDimensionLabels: favoriteObject.hasOwnProperty('showDimensionLabels')
                ? favoriteObject.showDimensionLabels
                : true,
            hideEmptyRows: favoriteObject.hasOwnProperty('hideEmptyRows')
                ? favoriteObject.hideEmptyRows
                : true,
            showHierarchy: favoriteObject.hasOwnProperty('showHierarchy')
                ? favoriteObject.showHierarchy
                : true,
            displayList: checkForEventDataType(favoriteObject, type),
            rows: visualizationLayout.rows ? visualizationLayout.rows : ['pe'],
            columns: visualizationLayout.columns ? visualizationLayout.columns : ['dx'],
            legendSet: favoriteObject.legendSet || null,
            styles: null
        };
    }
    /**
     * @param {?} favoriteObject
     * @param {?} favoriteType
     * @return {?}
     */
    function checkForEventDataType(favoriteObject, favoriteType) {
        var /** @type {?} */ displayList = false;
        if (favoriteType === 'EVENT_REPORT') {
            if (favoriteObject.hasOwnProperty('dataType') &&
                favoriteObject.dataType === 'EVENTS') {
                displayList = true;
            }
        }
        return displayList;
    }

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    function __values(o) {
        var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
        if (m)
            return m.call(o);
        return {
            next: function () {
                if (o && i >= o.length)
                    o = void 0;
                return { value: o && o[i++], done: !o };
            }
        };
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    /**
     * @param {?} analyticsObject
     * @param {?} tableConfiguration
     * @return {?}
     */
    function drawTable(analyticsObject, tableConfiguration) {
        var /** @type {?} */ legendClasses = tableConfiguration.legendSet
            ? tableConfiguration.legendSet.legends
            : null;
        var /** @type {?} */ table = {
            headers: [],
            columns: [],
            rows: [],
            titles: {
                rows: [],
                column: []
            },
            titlesAvailable: false,
            hasParentOu: false
        };
        if (tableConfiguration.hasOwnProperty('title')) {
            table['title'] = tableConfiguration.title;
        }
        if (tableConfiguration.hasOwnProperty('subtitle')) {
            table['subtitle'] = tableConfiguration.subtitle;
        }
        if (tableConfiguration.displayList) {
            table.headers[0] = {
                items: [],
                style: ''
            };
            tableConfiguration.columns[tableConfiguration.columns.indexOf('pe')] =
                'eventdate';
            tableConfiguration.columns[tableConfiguration.columns.indexOf('ou')] =
                'ouname';
            try {
                for (var _a = __values(tableConfiguration.columns), _b = _a.next(); !_b.done; _b = _a.next()) {
                    var item = _b.value;
                    table.headers[0].items.push({
                        name: analyticsObject.headers[getTitleIndex(analyticsObject.headers, item)]
                            .column,
                        span: 1
                    });
                }
            }
            catch (e_1_1) {
                e_1 = { error: e_1_1 };
            }
            finally {
                try {
                    if (_b && !_b.done && (_c = _a.return))
                        _c.call(_a);
                }
                finally {
                    if (e_1)
                        throw e_1.error;
                }
            }
            try {
                for (var _d = __values(analyticsObject.rows), _e = _d.next(); !_e.done; _e = _d.next()) {
                    var item = _e.value;
                    var /** @type {?} */ column_items = [];
                    try {
                        for (var _f = __values(tableConfiguration.columns), _g = _f.next(); !_g.done; _g = _f.next()) {
                            var col = _g.value;
                            var /** @type {?} */ index = getTitleIndex(analyticsObject.headers, col);
                            column_items.push({
                                name: '',
                                display: true,
                                row_span: '1',
                                // color:getColor(item[index],)
                                val: item[index]
                            });
                        }
                    }
                    catch (e_2_1) {
                        e_2 = { error: e_2_1 };
                    }
                    finally {
                        try {
                            if (_g && !_g.done && (_h = _f.return))
                                _h.call(_f);
                        }
                        finally {
                            if (e_2)
                                throw e_2.error;
                        }
                    }
                    table.rows.push({
                        headers: [],
                        items: column_items
                    });
                }
            }
            catch (e_3_1) {
                e_3 = { error: e_3_1 };
            }
            finally {
                try {
                    if (_e && !_e.done && (_j = _d.return))
                        _j.call(_d);
                }
                finally {
                    if (e_3)
                        throw e_3.error;
                }
            }
        }
        else {
            // add names to titles array
            if (tableConfiguration.showDimensionLabels) {
                table.titlesAvailable = true;
                try {
                    for (var _k = __values(tableConfiguration.columns), _l = _k.next(); !_l.done; _l = _k.next()) {
                        var item = _l.value;
                        table.titles.column.push(analyticsObject.headers[getTitleIndex(analyticsObject.headers, item)]
                            .column);
                    }
                }
                catch (e_4_1) {
                    e_4 = { error: e_4_1 };
                }
                finally {
                    try {
                        if (_l && !_l.done && (_m = _k.return))
                            _m.call(_k);
                    }
                    finally {
                        if (e_4)
                            throw e_4.error;
                    }
                }
                try {
                    for (var _o = __values(tableConfiguration.rows), _p = _o.next(); !_p.done; _p = _o.next()) {
                        var item = _p.value;
                        table.titles.rows.push(analyticsObject.headers[getTitleIndex(analyticsObject.headers, item)]
                            .column);
                    }
                }
                catch (e_5_1) {
                    e_5 = { error: e_5_1 };
                }
                finally {
                    try {
                        if (_p && !_p.done && (_q = _o.return))
                            _q.call(_o);
                    }
                    finally {
                        if (e_5)
                            throw e_5.error;
                    }
                }
            }
            try {
                for (var _r = __values(tableConfiguration.columns), _s = _r.next(); !_s.done; _s = _r.next()) {
                    var columnItem = _s.value;
                    var /** @type {?} */ dimension = calculateColSpan(analyticsObject, tableConfiguration.columns, columnItem);
                    var /** @type {?} */ currentColumnItems = prepareSingleCategories(analyticsObject, columnItem);
                    var /** @type {?} */ headerItem = [];
                    for (var /** @type {?} */ i = 0; i < dimension.duplication; i++) {
                        try {
                            for (var currentColumnItems_1 = __values(currentColumnItems), currentColumnItems_1_1 = currentColumnItems_1.next(); !currentColumnItems_1_1.done; currentColumnItems_1_1 = currentColumnItems_1.next()) {
                                var currentItem = currentColumnItems_1_1.value;
                                headerItem.push({
                                    name: currentItem.name,
                                    span: dimension.col_span,
                                    type: currentItem.type,
                                    id: currentItem.uid
                                });
                            }
                        }
                        catch (e_6_1) {
                            e_6 = { error: e_6_1 };
                        }
                        finally {
                            try {
                                if (currentColumnItems_1_1 && !currentColumnItems_1_1.done && (_t = currentColumnItems_1.return))
                                    _t.call(currentColumnItems_1);
                            }
                            finally {
                                if (e_6)
                                    throw e_6.error;
                            }
                        }
                    }
                    var /** @type {?} */ styles = '';
                    if (tableConfiguration.hasOwnProperty('style')) {
                        if (tableConfiguration.styles.hasOwnProperty(columnItem)) {
                            styles = tableConfiguration.styles[columnItem];
                        }
                    }
                    table.headers.push({ items: headerItem, style: styles });
                }
            }
            catch (e_7_1) {
                e_7 = { error: e_7_1 };
            }
            finally {
                try {
                    if (_s && !_s.done && (_u = _r.return))
                        _u.call(_r);
                }
                finally {
                    if (e_7)
                        throw e_7.error;
                }
            }
            try {
                for (var _v = __values(tableConfiguration.rows), _w = _v.next(); !_w.done; _w = _v.next()) {
                    var rowItem = _w.value;
                    table.columns.push(rowItem);
                }
            }
            catch (e_8_1) {
                e_8 = { error: e_8_1 };
            }
            finally {
                try {
                    if (_w && !_w.done && (_x = _v.return))
                        _x.call(_v);
                }
                finally {
                    if (e_8)
                        throw e_8.error;
                }
            }
            // Preparing table columns
            var /** @type {?} */ column_length = tableConfiguration.columns.length;
            var /** @type {?} */ column_items_array = [];
            for (var /** @type {?} */ i = 0; i < column_length; i++) {
                var /** @type {?} */ currentRowItems = prepareSingleCategories(analyticsObject, tableConfiguration.columns[i]);
                column_items_array.push(currentRowItems);
            }
            var /** @type {?} */ table_columns_array = [];
            for (var /** @type {?} */ i = 0; i < column_items_array.length; i++) {
                if (table_columns_array.length === 0) {
                    try {
                        for (var _y = __values(column_items_array[i]), _z = _y.next(); !_z.done; _z = _y.next()) {
                            var item = _z.value;
                            table_columns_array.push([item]);
                        }
                    }
                    catch (e_9_1) {
                        e_9 = { error: e_9_1 };
                    }
                    finally {
                        try {
                            if (_z && !_z.done && (_0 = _y.return))
                                _0.call(_y);
                        }
                        finally {
                            if (e_9)
                                throw e_9.error;
                        }
                    }
                }
                else {
                    var /** @type {?} */ temp_arr = table_columns_array.concat();
                    table_columns_array = [];
                    try {
                        for (var temp_arr_1 = __values(temp_arr), temp_arr_1_1 = temp_arr_1.next(); !temp_arr_1_1.done; temp_arr_1_1 = temp_arr_1.next()) {
                            var item = temp_arr_1_1.value;
                            try {
                                for (var _1 = __values(column_items_array[i]), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                                    var val = _2.value;
                                    if (item instanceof Array) {
                                        var /** @type {?} */ tempArr = Array.from(item);
                                        table_columns_array.push(tempArr.concat([val]));
                                    }
                                    else {
                                        table_columns_array.push([item, val]);
                                    }
                                }
                            }
                            catch (e_10_1) {
                                e_10 = { error: e_10_1 };
                            }
                            finally {
                                try {
                                    if (_2 && !_2.done && (_3 = _1.return))
                                        _3.call(_1);
                                }
                                finally {
                                    if (e_10)
                                        throw e_10.error;
                                }
                            }
                        }
                    }
                    catch (e_11_1) {
                        e_11 = { error: e_11_1 };
                    }
                    finally {
                        try {
                            if (temp_arr_1_1 && !temp_arr_1_1.done && (_4 = temp_arr_1.return))
                                _4.call(temp_arr_1);
                        }
                        finally {
                            if (e_11)
                                throw e_11.error;
                        }
                    }
                }
            }
            // Preparing table rows
            var /** @type {?} */ rows_length = tableConfiguration.rows.length;
            var /** @type {?} */ row_items_array = [];
            for (var /** @type {?} */ i = 0; i < rows_length; i++) {
                var /** @type {?} */ dimension = calculateColSpan(analyticsObject, tableConfiguration.rows, tableConfiguration.rows[i]);
                var /** @type {?} */ currentRowItems = prepareSingleCategories(analyticsObject, tableConfiguration.rows[i]);
                row_items_array.push({ items: currentRowItems, dimensions: dimension });
            }
            var /** @type {?} */ table_rows_array = [];
            for (var /** @type {?} */ i = 0; i < row_items_array.length; i++) {
                if (table_rows_array.length === 0) {
                    try {
                        for (var _5 = __values(row_items_array[i].items), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                            var item = _6.value;
                            item.dimensions = row_items_array[i].dimensions;
                            table_rows_array.push([item]);
                        }
                    }
                    catch (e_12_1) {
                        e_12 = { error: e_12_1 };
                    }
                    finally {
                        try {
                            if (_6 && !_6.done && (_7 = _5.return))
                                _7.call(_5);
                        }
                        finally {
                            if (e_12)
                                throw e_12.error;
                        }
                    }
                }
                else {
                    var /** @type {?} */ temp_arr = table_rows_array.concat();
                    table_rows_array = [];
                    try {
                        for (var temp_arr_2 = __values(temp_arr), temp_arr_2_1 = temp_arr_2.next(); !temp_arr_2_1.done; temp_arr_2_1 = temp_arr_2.next()) {
                            var item = temp_arr_2_1.value;
                            try {
                                for (var _8 = __values(row_items_array[i].items), _9 = _8.next(); !_9.done; _9 = _8.next()) {
                                    var val = _9.value;
                                    val.dimensions = row_items_array[i].dimensions;
                                    if (item instanceof Array) {
                                        var /** @type {?} */ tempArr = Array.from(item);
                                        table_rows_array.push(tempArr.concat([val]));
                                    }
                                    else {
                                        table_rows_array.push([item, val]);
                                    }
                                }
                            }
                            catch (e_13_1) {
                                e_13 = { error: e_13_1 };
                            }
                            finally {
                                try {
                                    if (_9 && !_9.done && (_10 = _8.return))
                                        _10.call(_8);
                                }
                                finally {
                                    if (e_13)
                                        throw e_13.error;
                                }
                            }
                        }
                    }
                    catch (e_14_1) {
                        e_14 = { error: e_14_1 };
                    }
                    finally {
                        try {
                            if (temp_arr_2_1 && !temp_arr_2_1.done && (_11 = temp_arr_2.return))
                                _11.call(temp_arr_2);
                        }
                        finally {
                            if (e_14)
                                throw e_14.error;
                        }
                    }
                }
            }
            var /** @type {?} */ counter = 0;
            if (table_rows_array.length !== 0) {
                try {
                    for (var table_rows_array_1 = __values(table_rows_array), table_rows_array_1_1 = table_rows_array_1.next(); !table_rows_array_1_1.done; table_rows_array_1_1 = table_rows_array_1.next()) {
                        var rowItem = table_rows_array_1_1.value;
                        var /** @type {?} */ item = {
                            items: [],
                            headers: rowItem
                        };
                        try {
                            for (var rowItem_1 = __values(rowItem), rowItem_1_1 = rowItem_1.next(); !rowItem_1_1.done; rowItem_1_1 = rowItem_1.next()) {
                                var val = rowItem_1_1.value;
                                if (counter === 0 || counter % val.dimensions.col_span === 0) {
                                    item.items.push({
                                        type: val.type,
                                        name: val.uid,
                                        val: val.name,
                                        row_span: val.dimensions.col_span,
                                        header: true
                                    });
                                }
                            }
                        }
                        catch (e_15_1) {
                            e_15 = { error: e_15_1 };
                        }
                        finally {
                            try {
                                if (rowItem_1_1 && !rowItem_1_1.done && (_12 = rowItem_1.return))
                                    _12.call(rowItem_1);
                            }
                            finally {
                                if (e_15)
                                    throw e_15.error;
                            }
                        }
                        try {
                            for (var table_columns_array_1 = __values(table_columns_array), table_columns_array_1_1 = table_columns_array_1.next(); !table_columns_array_1_1.done; table_columns_array_1_1 = table_columns_array_1.next()) {
                                var colItem = table_columns_array_1_1.value;
                                var /** @type {?} */ dataItem = [];
                                try {
                                    for (var rowItem_2 = __values(rowItem), rowItem_2_1 = rowItem_2.next(); !rowItem_2_1.done; rowItem_2_1 = rowItem_2.next()) {
                                        var val = rowItem_2_1.value;
                                        dataItem.push({ type: val.type, value: val.uid });
                                    }
                                }
                                catch (e_16_1) {
                                    e_16 = { error: e_16_1 };
                                }
                                finally {
                                    try {
                                        if (rowItem_2_1 && !rowItem_2_1.done && (_13 = rowItem_2.return))
                                            _13.call(rowItem_2);
                                    }
                                    finally {
                                        if (e_16)
                                            throw e_16.error;
                                    }
                                }
                                try {
                                    for (var colItem_1 = __values(colItem), colItem_1_1 = colItem_1.next(); !colItem_1_1.done; colItem_1_1 = colItem_1.next()) {
                                        var val = colItem_1_1.value;
                                        dataItem.push({ type: val.type, value: val.uid });
                                    }
                                }
                                catch (e_17_1) {
                                    e_17 = { error: e_17_1 };
                                }
                                finally {
                                    try {
                                        if (colItem_1_1 && !colItem_1_1.done && (_14 = colItem_1.return))
                                            _14.call(colItem_1);
                                    }
                                    finally {
                                        if (e_17)
                                            throw e_17.error;
                                    }
                                }
                                item.items.push({
                                    name: '',
                                    val: getDataValue(analyticsObject, dataItem),
                                    color: getDataValueColor(legendClasses, getDataValue(analyticsObject, dataItem)),
                                    row_span: '1',
                                    display: true
                                });
                            }
                        }
                        catch (e_18_1) {
                            e_18 = { error: e_18_1 };
                        }
                        finally {
                            try {
                                if (table_columns_array_1_1 && !table_columns_array_1_1.done && (_15 = table_columns_array_1.return))
                                    _15.call(table_columns_array_1);
                            }
                            finally {
                                if (e_18)
                                    throw e_18.error;
                            }
                        }
                        if (tableConfiguration.hasOwnProperty('hideEmptyRows') &&
                            tableConfiguration.hideEmptyRows) {
                            if (!checkZeros(tableConfiguration.rows.length, item.items)) {
                                table.rows.push(item);
                            }
                        }
                        else {
                            table.rows.push(item);
                        }
                        counter++;
                    }
                }
                catch (e_19_1) {
                    e_19 = { error: e_19_1 };
                }
                finally {
                    try {
                        if (table_rows_array_1_1 && !table_rows_array_1_1.done && (_16 = table_rows_array_1.return))
                            _16.call(table_rows_array_1);
                    }
                    finally {
                        if (e_19)
                            throw e_19.error;
                    }
                }
            }
            else {
                var /** @type {?} */ item = {
                    items: [],
                    headers: []
                };
                try {
                    for (var table_columns_array_2 = __values(table_columns_array), table_columns_array_2_1 = table_columns_array_2.next(); !table_columns_array_2_1.done; table_columns_array_2_1 = table_columns_array_2.next()) {
                        var colItem = table_columns_array_2_1.value;
                        var /** @type {?} */ dataItem = [];
                        try {
                            for (var colItem_2 = __values(colItem), colItem_2_1 = colItem_2.next(); !colItem_2_1.done; colItem_2_1 = colItem_2.next()) {
                                var val = colItem_2_1.value;
                                dataItem.push({ type: val.type, value: val.uid });
                            }
                        }
                        catch (e_20_1) {
                            e_20 = { error: e_20_1 };
                        }
                        finally {
                            try {
                                if (colItem_2_1 && !colItem_2_1.done && (_17 = colItem_2.return))
                                    _17.call(colItem_2);
                            }
                            finally {
                                if (e_20)
                                    throw e_20.error;
                            }
                        }
                        item.items.push({
                            name: '',
                            val: getDataValue(analyticsObject, dataItem),
                            row_span: '1',
                            display: true
                        });
                    }
                }
                catch (e_21_1) {
                    e_21 = { error: e_21_1 };
                }
                finally {
                    try {
                        if (table_columns_array_2_1 && !table_columns_array_2_1.done && (_18 = table_columns_array_2.return))
                            _18.call(table_columns_array_2);
                    }
                    finally {
                        if (e_21)
                            throw e_21.error;
                    }
                }
                if (tableConfiguration.hasOwnProperty('hideEmptyRows') &&
                    tableConfiguration.hideEmptyRows) {
                    if (!checkZeros(tableConfiguration.rows.length, item.items)) {
                        table.rows.push(item);
                    }
                }
                else {
                    table.rows.push(item);
                }
            }
        }
        // todo improve total options to also work for event table
        // return _getSanitizedTableObject(table, tableConfiguration);
        return table;
        var e_1, _c, e_3, _j, e_2, _h, e_4, _m, e_5, _q, e_7, _u, e_6, _t, e_8, _x, e_9, _0, e_11, _4, e_10, _3, e_12, _7, e_14, _11, e_13, _10, e_19, _16, e_15, _12, e_18, _15, e_16, _13, e_17, _14, e_21, _18, e_20, _17;
    }
    /**
     * @param {?} analyticsObjectHeaders
     * @param {?} name
     * @return {?}
     */
    function getTitleIndex(analyticsObjectHeaders, name) {
        var /** @type {?} */ index = 0;
        var /** @type {?} */ counter = 0;
        try {
            for (var analyticsObjectHeaders_1 = __values(analyticsObjectHeaders), analyticsObjectHeaders_1_1 = analyticsObjectHeaders_1.next(); !analyticsObjectHeaders_1_1.done; analyticsObjectHeaders_1_1 = analyticsObjectHeaders_1.next()) {
                var header = analyticsObjectHeaders_1_1.value;
                if (header.name === name) {
                    index = counter;
                }
                counter++;
            }
        }
        catch (e_22_1) {
            e_22 = { error: e_22_1 };
        }
        finally {
            try {
                if (analyticsObjectHeaders_1_1 && !analyticsObjectHeaders_1_1.done && (_a = analyticsObjectHeaders_1.return))
                    _a.call(analyticsObjectHeaders_1);
            }
            finally {
                if (e_22)
                    throw e_22.error;
            }
        }
        return index;
        var e_22, _a;
    }
    /**
     * @param {?} analyticsObject
     * @param {?} array
     * @param {?} item
     * @return {?}
     */
    function calculateColSpan(analyticsObject, array, item) {
        var /** @type {?} */ indexOfItem = array.indexOf(item);
        var /** @type {?} */ array_length = array.length;
        var /** @type {?} */ last_index = array_length - 1;
        var /** @type {?} */ dimensions = { col_span: 1, duplication: 1 };
        for (var /** @type {?} */ i = last_index; i > indexOfItem; i--) {
            var /** @type {?} */ arr = prepareSingleCategories(analyticsObject, array[i]);
            dimensions.col_span = dimensions.col_span * arr.length;
        }
        for (var /** @type {?} */ i = 0; i < indexOfItem; i++) {
            var /** @type {?} */ arr = prepareSingleCategories(analyticsObject, array[i]);
            dimensions.duplication = dimensions.duplication * arr.length;
        }
        return dimensions;
    }
    /**
     * @param {?} initialAnalytics
     * @param {?} itemIdentifier
     * @param {?=} preDefinedItems
     * @return {?}
     */
    function prepareSingleCategories(initialAnalytics, itemIdentifier, preDefinedItems) {
        if (preDefinedItems === void 0) {
            preDefinedItems = [];
        }
        var /** @type {?} */ analyticsObject = sanitizeIncomingAnalytics(initialAnalytics);
        var /** @type {?} */ structure = [];
        if (preDefinedItems.length === 0) {
            try {
                for (var _a = __values(getMetadataArray(analyticsObject, itemIdentifier)), _b = _a.next(); !_b.done; _b = _a.next()) {
                    var val = _b.value;
                    structure.push({
                        name: analyticsObject.metaData.names[val],
                        uid: val,
                        type: itemIdentifier
                    });
                }
            }
            catch (e_23_1) {
                e_23 = { error: e_23_1 };
            }
            finally {
                try {
                    if (_b && !_b.done && (_c = _a.return))
                        _c.call(_a);
                }
                finally {
                    if (e_23)
                        throw e_23.error;
                }
            }
        }
        if (preDefinedItems.length !== 0) {
            try {
                for (var preDefinedItems_1 = __values(preDefinedItems), preDefinedItems_1_1 = preDefinedItems_1.next(); !preDefinedItems_1_1.done; preDefinedItems_1_1 = preDefinedItems_1.next()) {
                    var val = preDefinedItems_1_1.value;
                    structure.push({
                        name: analyticsObject.metaData.names[val],
                        uid: val,
                        type: itemIdentifier
                    });
                }
            }
            catch (e_24_1) {
                e_24 = { error: e_24_1 };
            }
            finally {
                try {
                    if (preDefinedItems_1_1 && !preDefinedItems_1_1.done && (_d = preDefinedItems_1.return))
                        _d.call(preDefinedItems_1);
                }
                finally {
                    if (e_24)
                        throw e_24.error;
                }
            }
        }
        return structure;
        var e_23, _c, e_24, _d;
    }
    /**
     * @param {?} analyticsObject
     * @return {?}
     */
    function sanitizeIncomingAnalytics(analyticsObject) {
        return analyticsObject;
    }
    /**
     * @param {?} analyticsObject
     * @param {?} metadataType
     * @return {?}
     */
    function getMetadataArray(analyticsObject, metadataType) {
        var /** @type {?} */ metadataArray = [];
        if (metadataType === 'dx') {
            metadataArray = analyticsObject.metaData.dx;
        }
        else if (metadataType === 'ou') {
            metadataArray = analyticsObject.metaData.ou;
        }
        else if (metadataType === 'co') {
            metadataArray = analyticsObject.metaData.co;
        }
        else if (metadataType === 'pe') {
            metadataArray = analyticsObject.metaData.pe;
        }
        else {
            metadataArray = analyticsObject.metaData[metadataType];
        }
        return metadataArray;
    }
    /**
     * @param {?} analyticsObject
     * @param {?=} dataItems
     * @return {?}
     */
    function getDataValue(analyticsObject, dataItems) {
        if (dataItems === void 0) {
            dataItems = [];
        }
        var /** @type {?} */ num = null;
        try {
            for (var _a = __values(analyticsObject.rows), _b = _a.next(); !_b.done; _b = _a.next()) {
                var value = _b.value;
                var /** @type {?} */ counter = 0;
                try {
                    for (var dataItems_1 = __values(dataItems), dataItems_1_1 = dataItems_1.next(); !dataItems_1_1.done; dataItems_1_1 = dataItems_1.next()) {
                        var item = dataItems_1_1.value;
                        if (value[getTitleIndex(analyticsObject.headers, item.type)] === item.value) {
                            counter++;
                        }
                    }
                }
                catch (e_25_1) {
                    e_25 = { error: e_25_1 };
                }
                finally {
                    try {
                        if (dataItems_1_1 && !dataItems_1_1.done && (_c = dataItems_1.return))
                            _c.call(dataItems_1);
                    }
                    finally {
                        if (e_25)
                            throw e_25.error;
                    }
                }
                if (counter === dataItems.length) {
                    if (isNaN(value[getTitleIndex(analyticsObject.headers, 'value')])) {
                        num = value[getTitleIndex(analyticsObject.headers, 'value')];
                    }
                    else {
                        num += parseFloat(value[getTitleIndex(analyticsObject.headers, 'value')]);
                    }
                }
            }
        }
        catch (e_26_1) {
            e_26 = { error: e_26_1 };
        }
        finally {
            try {
                if (_b && !_b.done && (_d = _a.return))
                    _d.call(_a);
            }
            finally {
                if (e_26)
                    throw e_26.error;
            }
        }
        return num;
        var e_26, _d, e_25, _c;
    }
    /**
     * @param {?} legendClasses
     * @param {?} value
     * @return {?}
     */
    function getDataValueColor(legendClasses, value) {
        var /** @type {?} */ color = '';
        if (!isNaN(value) && legendClasses) {
            legendClasses.forEach(function (legendClass) {
                if (legendClass.startValue <= value && legendClass.endValue > value) {
                    color = legendClass.color;
                }
                // if (legendClass.startValue < value && legendClass.endValue >= value) {
                // }
            });
        }
        return color;
    }
    /**
     * @param {?} stating_length
     * @param {?} array
     * @return {?}
     */
    function checkZeros(stating_length, array) {
        var /** @type {?} */ checker = true;
        for (var /** @type {?} */ i = stating_length; i < array.length; i++) {
            if (array[i].name === '' && array[i].val != null) {
                checker = false;
            }
        }
        return checker;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var TableListComponent = (function () {
        function TableListComponent() {
            this.tableLayers = [];
        }
        /**
         * @return {?}
         */
        TableListComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (this.visualizationLayers && this.visualizationLayers.length > 0) {
                    this.tableLayers = this.visualizationLayers.map(function (layer) {
                        return {
                            tableConfiguration: getTableConfiguration(layer.config || {}, layer.layout, _this.visualizationType),
                            analyticsObject: layer.analytics
                        };
                    });
                }
            };
        TableListComponent.decorators = [
            { type: core.Component, args: [{
                        // tslint:disable-next-line:component-selector
                        selector: 'ngx-dhis2-table-list',
                        template: "<div class=\"row\">\n    <div class=\"col-12\" *ngFor=\"let tableLayer of tableLayers\">\n        <ngx-dhis2-table-item [analyticsObject]=\"tableLayer.analyticsObject\" [tableConfiguration]=\"tableLayer.tableConfiguration\">\n        </ngx-dhis2-table-item>\n    </div>\n</div>",
                        styles: [""]
                    },] },
        ];
        /** @nocollapse */
        TableListComponent.ctorParameters = function () { return []; };
        TableListComponent.propDecorators = {
            visualizationLayers: [{ type: core.Input }],
            visualizationType: [{ type: core.Input }]
        };
        return TableListComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var TableItemComponent = (function () {
        function TableItemComponent() {
            this.sort_direction = [];
            this.current_sorting = [];
            this.tableObject = null;
        }
        /**
         * @return {?}
         */
        TableItemComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                if (this.analyticsObject && this.tableConfiguration) {
                    this.tableObject = drawTable(this.analyticsObject, this.tableConfiguration);
                }
            };
        /**
         * @param {?} tableObject
         * @param {?} n
         * @param {?} isLastItem
         * @return {?}
         */
        TableItemComponent.prototype.sortData = /**
         * @param {?} tableObject
         * @param {?} n
         * @param {?} isLastItem
         * @return {?}
         */
            function (tableObject, n, isLastItem) {
                if (tableObject.columns.length === 1 && isLastItem) {
                    this.current_sorting = [];
                    this.current_sorting[n] = true;
                    var /** @type {?} */ table = void 0, /** @type {?} */ rows = void 0, /** @type {?} */ switching = void 0, /** @type {?} */ i = void 0, /** @type {?} */ x = void 0, /** @type {?} */ y = void 0, /** @type {?} */ shouldSwitch = void 0, /** @type {?} */ dir = void 0, /** @type {?} */ switchcount = 0;
                    table = document.getElementById('myPivotTable');
                    switching = true;
                    //  Set the sorting direction to ascending:
                    dir = 'asc';
                    /*Make a loop that will continue until
                           no switching has been done:*/
                    while (switching) {
                        //  start by saying: no switching is done:
                        switching = false;
                        rows = table.getElementsByTagName('TR');
                        /*Loop through all table rows (except the
                                 first, which contains table headers):*/
                        for (i = 0; i < rows.length - 1; i++) {
                            // start by saying there should be no switching:
                            shouldSwitch = false;
                            /*Get the two elements you want to compare,
                                       one from current row and one from the next:*/
                            x = rows[i].getElementsByTagName('TD')[n];
                            y = rows[i + 1].getElementsByTagName('TD')[n];
                            /*check if the two rows should switch place,
                                       based on the direction, asc or desc:*/
                            if (dir === 'asc') {
                                if (parseFloat(x.innerHTML)) {
                                    if (parseFloat(x.innerHTML) > parseFloat(y.innerHTML)) {
                                        // if so, mark as a switch and break the loop:
                                        shouldSwitch = true;
                                        break;
                                    }
                                }
                                else {
                                    if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                                        // if so, mark as a switch and break the loop:
                                        shouldSwitch = true;
                                        break;
                                    }
                                }
                                this.sort_direction[n] = 'asc';
                            }
                            else if (dir === 'desc') {
                                if (parseFloat(x.innerHTML)) {
                                    if (parseFloat(x.innerHTML) < parseFloat(y.innerHTML)) {
                                        // if so, mark as a switch and break the loop:
                                        shouldSwitch = true;
                                        break;
                                    }
                                }
                                else {
                                    if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                                        // if so, mark as a switch and break the loop:
                                        shouldSwitch = true;
                                        break;
                                    }
                                }
                                this.sort_direction[n] = 'desc';
                            }
                        }
                        if (shouldSwitch) {
                            /*If a switch has been marked, make the switch
                                       and mark that a switch has been done:*/
                            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                            switching = true;
                            // Each time a switch is done, increase this count by 1:
                            switchcount++;
                        }
                        else {
                            /*If no switching has been done AND the direction is 'asc',
                                       set the direction to 'desc' and run the while loop again.*/
                            if (switchcount === 0 && dir === 'asc') {
                                dir = 'desc';
                                this.sort_direction[n] = 'desc';
                                switching = true;
                            }
                        }
                    }
                }
            };
        TableItemComponent.decorators = [
            { type: core.Component, args: [{
                        // tslint:disable-next-line:component-selector
                        selector: 'ngx-dhis2-table-item',
                        template: "<div class=\"row\">\n    <div class=\"col-md-12\" *ngIf=\"tableObject\">\n        <h5 style=\"margin-top: 80px\" class=\"text-center\" *ngIf=\"tableObject.rows.length == 0\"> No data to display</h5>\n\n        <div *ngIf=\"tableObject\" style=\"padding: 3px\">\n            <!--<h4 *ngIf=\"tableObject.rows.length != 0\" class=\"text-center\" style=\"margin-bottom: 0px\">{{tableObject?.title}}</h4>-->\n            <table class=\"table table-bordered table-responsive table-condensed custom-table\" *ngIf=\"tableObject.rows.length != 0\">\n                <thead>\n                    <!--title-->\n                    <tr class=\"table-title\">\n                        <th [attr.colspan]=\"tableObject.rows[0].items.length\">\n                            <h4 style=\"margin: 0px\" class=\"text-center\">{{tableObject.subtitle}} </h4>\n                        </th>\n                    </tr>\n                    <!--headers-->\n                    <tr *ngFor=\"let header of tableObject.headers; let j = index\" class=\"header-column\">\n                        <th *ngIf=\"tableObject.hasParentOu\"></th>\n                        <th *ngFor=\"let table_column of tableObject.columns; let i = index\" style=\"text-align: center\">\n                            <span *ngIf=\"i==tableObject.columns.length-1 && j==tableObject.headers.length-1 && tableObject.titlesAvailable\">{{ tableObject.titles.rows[i] }} / {{ tableObject.titles.column[j]}}</span>\n                            <span *ngIf=\"i != tableObject.columns.length-1\">{{ tableObject.titles.rows[i] }}</span>\n                            <span *ngIf=\"j != tableObject.headers.length-1\">{{ tableObject.titles.column[j] }}</span>\n                        </th>\n                        <th *ngFor=\"let header_column of header.items; let i=index\" [colSpan]=\"header_column.span\" style=\"text-align: center\" (click)=\"sortData(tableObject,i+tableObject.columns.length,j+1==tableObject.headers.length)\">\n                            {{ header_column.name }}\n                            <span *ngIf=\"j+1==tableObject.headers.length && current_sorting[i+tableObject.columns.length] && sort_direction[i+tableObject.columns.length] == 'asc'\" class=\"glyphicon glyphicon-triangle-top pull-right\"></span>\n                            <span *ngIf=\"j+1==tableObject.headers.length && current_sorting[i+tableObject.columns.length] && sort_direction[i+tableObject.columns.length] == 'desc'\" class=\"glyphicon glyphicon-triangle-bottom pull-right\"></span>\n                        </th>\n                    </tr>\n                </thead>\n                <tbody id=\"myPivotTable\">\n                    <tr *ngFor=\"let row of tableObject.rows\" [ngClass]=\"{'sub-total': row.sub_total}\">\n                        <td *ngFor=\"let header_column of row.items;let i = index\" [ngClass]=\"{'header-column': header_column.name != ''}\" style=\"text-align: center;vertical-align: middle\" [attr.rowspan]=\"header_column.row_span\" [style.background]=\"header_column.color\">\n                            {{ header_column.val }}\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n\n\n        </div>\n    </div>\n</div>",
                        styles: [".table-item-container{overflow:hidden}.custom-table{display:table;border-style:none!important;width:100%}.custom-table td,.custom-table th{border:thin solid #f1f1f1}.custom-table>tbody>tr>td,.custom-table>thead>tr>th{font-size:13px!important}table tr th{background-color:rgba(238,238,238,.29);padding:4px;text-align:center}table tr td{padding:4px}table tr td:first-child{background-color:rgba(238,238,238,.29)}.table-title{font-size:13px;font-weight:600;text-align:center}"]
                    },] },
        ];
        /** @nocollapse */
        TableItemComponent.ctorParameters = function () { return []; };
        TableItemComponent.propDecorators = {
            tableConfiguration: [{ type: core.Input }],
            analyticsObject: [{ type: core.Input }]
        };
        return TableItemComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var NgxDhis2TableModule = (function () {
        function NgxDhis2TableModule() {
        }
        NgxDhis2TableModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [common.CommonModule],
                        declarations: [TableListComponent, TableItemComponent],
                        exports: [TableListComponent, TableItemComponent]
                    },] },
        ];
        return NgxDhis2TableModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    exports.NgxDhis2TableModule = NgxDhis2TableModule;
    exports.ɵb = TableItemComponent;
    exports.ɵa = TableListComponent;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlzcHR6LW5neC1kaGlzMi10YWJsZS51bWQuanMubWFwIiwic291cmNlcyI6WyJuZzovL0BoaXNwdHovbmd4LWRoaXMyLXRhYmxlL2xpYi9oZWxwZXJzL2dldC10YWJsZS1jb25maWd1cmF0aW9uLmhlbHBlci50cyIsbnVsbCwibmc6Ly9AaGlzcHR6L25neC1kaGlzMi10YWJsZS9saWIvaGVscGVycy9kcmF3LXRhYmxlLmhlbHBlci50cyIsIm5nOi8vQGhpc3B0ei9uZ3gtZGhpczItdGFibGUvbGliL2NvbXBvbmVudHMvdGFibGUtbGlzdC90YWJsZS1saXN0LmNvbXBvbmVudC50cyIsIm5nOi8vQGhpc3B0ei9uZ3gtZGhpczItdGFibGUvbGliL2NvbXBvbmVudHMvdGFibGUtaXRlbS90YWJsZS1pdGVtLmNvbXBvbmVudC50cyIsIm5nOi8vQGhpc3B0ei9uZ3gtZGhpczItdGFibGUvbGliL25neC1kaGlzMi10YWJsZS5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGFibGVDb25maWd1cmF0aW9uIH0gZnJvbSAnLi4vbW9kZWxzL3RhYmxlLWNvbmZpZ3VyYXRpb24nO1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRhYmxlQ29uZmlndXJhdGlvbihcbiAgZmF2b3JpdGVPYmplY3Q6IGFueSxcbiAgdmlzdWFsaXphdGlvbkxheW91dDogYW55LFxuICB0eXBlOiBzdHJpbmdcbik6IFRhYmxlQ29uZmlndXJhdGlvbiB7XG4gIHJldHVybiB7XG4gICAgdGl0bGU6IGZhdm9yaXRlT2JqZWN0Lmhhc093blByb3BlcnR5KCdkaXNwbGF5TmFtZScpXG4gICAgICA/IGZhdm9yaXRlT2JqZWN0LmRpc3BsYXlOYW1lXG4gICAgICA6IGZhdm9yaXRlT2JqZWN0Lmhhc093blByb3BlcnR5KCduYW1lJylcbiAgICAgICAgPyBmYXZvcml0ZU9iamVjdC5uYW1lXG4gICAgICAgIDogJycsXG4gICAgc3VidGl0bGU6IGZhdm9yaXRlT2JqZWN0Lmhhc093blByb3BlcnR5KCdzdWJ0aXRsZScpXG4gICAgICA/IGZhdm9yaXRlT2JqZWN0LnN1YnRpdGxlXG4gICAgICA6ICcnLFxuICAgIHNob3dDb2x1bW5Ub3RhbDogZmF2b3JpdGVPYmplY3QuaGFzT3duUHJvcGVydHkoJ2NvbFRvdGFsJylcbiAgICAgID8gZmF2b3JpdGVPYmplY3QuY29sVG90YWxcbiAgICAgIDogdHJ1ZSxcbiAgICBzaG93Q29sdW1uU3VidG90YWw6IGZhdm9yaXRlT2JqZWN0Lmhhc093blByb3BlcnR5KCdjb2xTdWJ0b3RhbCcpXG4gICAgICA/IGZhdm9yaXRlT2JqZWN0LmNvbFN1YnRvdGFsXG4gICAgICA6IHRydWUsXG4gICAgc2hvd1Jvd1RvdGFsOiBmYXZvcml0ZU9iamVjdC5oYXNPd25Qcm9wZXJ0eSgncm93VG90YWwnKVxuICAgICAgPyBmYXZvcml0ZU9iamVjdC5yb3dUb3RhbFxuICAgICAgOiB0cnVlLFxuICAgIHNob3dSb3dTdWJ0b3RhbDogZmF2b3JpdGVPYmplY3QuaGFzT3duUHJvcGVydHkoJ3Jvd1N1YnRvdGFsJylcbiAgICAgID8gZmF2b3JpdGVPYmplY3Qucm93U3VidG90YWxcbiAgICAgIDogdHJ1ZSxcbiAgICBzaG93RGltZW5zaW9uTGFiZWxzOiBmYXZvcml0ZU9iamVjdC5oYXNPd25Qcm9wZXJ0eSgnc2hvd0RpbWVuc2lvbkxhYmVscycpXG4gICAgICA/IGZhdm9yaXRlT2JqZWN0LnNob3dEaW1lbnNpb25MYWJlbHNcbiAgICAgIDogdHJ1ZSxcbiAgICBoaWRlRW1wdHlSb3dzOiBmYXZvcml0ZU9iamVjdC5oYXNPd25Qcm9wZXJ0eSgnaGlkZUVtcHR5Um93cycpXG4gICAgICA/IGZhdm9yaXRlT2JqZWN0LmhpZGVFbXB0eVJvd3NcbiAgICAgIDogdHJ1ZSxcbiAgICBzaG93SGllcmFyY2h5OiBmYXZvcml0ZU9iamVjdC5oYXNPd25Qcm9wZXJ0eSgnc2hvd0hpZXJhcmNoeScpXG4gICAgICA/IGZhdm9yaXRlT2JqZWN0LnNob3dIaWVyYXJjaHlcbiAgICAgIDogdHJ1ZSxcbiAgICBkaXNwbGF5TGlzdDogY2hlY2tGb3JFdmVudERhdGFUeXBlKGZhdm9yaXRlT2JqZWN0LCB0eXBlKSxcbiAgICByb3dzOiB2aXN1YWxpemF0aW9uTGF5b3V0LnJvd3MgPyB2aXN1YWxpemF0aW9uTGF5b3V0LnJvd3MgOiBbJ3BlJ10sXG4gICAgY29sdW1uczogdmlzdWFsaXphdGlvbkxheW91dC5jb2x1bW5zID8gdmlzdWFsaXphdGlvbkxheW91dC5jb2x1bW5zIDogWydkeCddLFxuICAgIGxlZ2VuZFNldDogZmF2b3JpdGVPYmplY3QubGVnZW5kU2V0IHx8IG51bGwsXG4gICAgc3R5bGVzOiBudWxsXG4gIH07XG59XG5cbmZ1bmN0aW9uIGNoZWNrRm9yRXZlbnREYXRhVHlwZShmYXZvcml0ZU9iamVjdCwgZmF2b3JpdGVUeXBlKTogYm9vbGVhbiB7XG4gIGxldCBkaXNwbGF5TGlzdCA9IGZhbHNlO1xuICBpZiAoZmF2b3JpdGVUeXBlID09PSAnRVZFTlRfUkVQT1JUJykge1xuICAgIGlmIChcbiAgICAgIGZhdm9yaXRlT2JqZWN0Lmhhc093blByb3BlcnR5KCdkYXRhVHlwZScpICYmXG4gICAgICBmYXZvcml0ZU9iamVjdC5kYXRhVHlwZSA9PT0gJ0VWRU5UUydcbiAgICApIHtcbiAgICAgIGRpc3BsYXlMaXN0ID0gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGRpc3BsYXlMaXN0O1xufVxuIiwiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCJpbXBvcnQgeyBUYWJsZUNvbmZpZ3VyYXRpb24gfSBmcm9tICcuLi9tb2RlbHMvdGFibGUtY29uZmlndXJhdGlvbic7XG5leHBvcnQgZnVuY3Rpb24gZHJhd1RhYmxlKFxuICBhbmFseXRpY3NPYmplY3QsXG4gIHRhYmxlQ29uZmlndXJhdGlvbjogVGFibGVDb25maWd1cmF0aW9uXG4pIHtcbiAgY29uc3QgbGVnZW5kQ2xhc3NlcyA9IHRhYmxlQ29uZmlndXJhdGlvbi5sZWdlbmRTZXRcbiAgICA/IHRhYmxlQ29uZmlndXJhdGlvbi5sZWdlbmRTZXQubGVnZW5kc1xuICAgIDogbnVsbDtcblxuICBjb25zdCB0YWJsZSA9IHtcbiAgICBoZWFkZXJzOiBbXSxcbiAgICBjb2x1bW5zOiBbXSxcbiAgICByb3dzOiBbXSxcbiAgICB0aXRsZXM6IHtcbiAgICAgIHJvd3M6IFtdLFxuICAgICAgY29sdW1uOiBbXVxuICAgIH0sXG4gICAgdGl0bGVzQXZhaWxhYmxlOiBmYWxzZSxcbiAgICBoYXNQYXJlbnRPdTogZmFsc2VcbiAgfTtcbiAgaWYgKHRhYmxlQ29uZmlndXJhdGlvbi5oYXNPd25Qcm9wZXJ0eSgndGl0bGUnKSkge1xuICAgIHRhYmxlWyd0aXRsZSddID0gdGFibGVDb25maWd1cmF0aW9uLnRpdGxlO1xuICB9XG4gIGlmICh0YWJsZUNvbmZpZ3VyYXRpb24uaGFzT3duUHJvcGVydHkoJ3N1YnRpdGxlJykpIHtcbiAgICB0YWJsZVsnc3VidGl0bGUnXSA9IHRhYmxlQ29uZmlndXJhdGlvbi5zdWJ0aXRsZTtcbiAgfVxuICBpZiAodGFibGVDb25maWd1cmF0aW9uLmRpc3BsYXlMaXN0KSB7XG4gICAgdGFibGUuaGVhZGVyc1swXSA9IHtcbiAgICAgIGl0ZW1zOiBbXSxcbiAgICAgIHN0eWxlOiAnJ1xuICAgIH07XG4gICAgdGFibGVDb25maWd1cmF0aW9uLmNvbHVtbnNbdGFibGVDb25maWd1cmF0aW9uLmNvbHVtbnMuaW5kZXhPZigncGUnKV0gPVxuICAgICAgJ2V2ZW50ZGF0ZSc7XG4gICAgdGFibGVDb25maWd1cmF0aW9uLmNvbHVtbnNbdGFibGVDb25maWd1cmF0aW9uLmNvbHVtbnMuaW5kZXhPZignb3UnKV0gPVxuICAgICAgJ291bmFtZSc7XG4gICAgZm9yIChjb25zdCBpdGVtIG9mIHRhYmxlQ29uZmlndXJhdGlvbi5jb2x1bW5zKSB7XG4gICAgICB0YWJsZS5oZWFkZXJzWzBdLml0ZW1zLnB1c2goe1xuICAgICAgICBuYW1lOlxuICAgICAgICAgIGFuYWx5dGljc09iamVjdC5oZWFkZXJzW2dldFRpdGxlSW5kZXgoYW5hbHl0aWNzT2JqZWN0LmhlYWRlcnMsIGl0ZW0pXVxuICAgICAgICAgICAgLmNvbHVtbixcbiAgICAgICAgc3BhbjogMVxuICAgICAgfSk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBhbmFseXRpY3NPYmplY3Qucm93cykge1xuICAgICAgY29uc3QgY29sdW1uX2l0ZW1zID0gW107XG4gICAgICBmb3IgKGNvbnN0IGNvbCBvZiB0YWJsZUNvbmZpZ3VyYXRpb24uY29sdW1ucykge1xuICAgICAgICBjb25zdCBpbmRleCA9IGdldFRpdGxlSW5kZXgoYW5hbHl0aWNzT2JqZWN0LmhlYWRlcnMsIGNvbCk7XG4gICAgICAgIGNvbHVtbl9pdGVtcy5wdXNoKHtcbiAgICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgICBkaXNwbGF5OiB0cnVlLFxuICAgICAgICAgIHJvd19zcGFuOiAnMScsXG4gICAgICAgICAgLy8gY29sb3I6Z2V0Q29sb3IoaXRlbVtpbmRleF0sKVxuICAgICAgICAgIHZhbDogaXRlbVtpbmRleF1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0YWJsZS5yb3dzLnB1c2goe1xuICAgICAgICBoZWFkZXJzOiBbXSxcbiAgICAgICAgaXRlbXM6IGNvbHVtbl9pdGVtc1xuICAgICAgfSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIGFkZCBuYW1lcyB0byB0aXRsZXMgYXJyYXlcbiAgICBpZiAodGFibGVDb25maWd1cmF0aW9uLnNob3dEaW1lbnNpb25MYWJlbHMpIHtcbiAgICAgIHRhYmxlLnRpdGxlc0F2YWlsYWJsZSA9IHRydWU7XG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGFibGVDb25maWd1cmF0aW9uLmNvbHVtbnMpIHtcbiAgICAgICAgdGFibGUudGl0bGVzLmNvbHVtbi5wdXNoKFxuICAgICAgICAgIGFuYWx5dGljc09iamVjdC5oZWFkZXJzW2dldFRpdGxlSW5kZXgoYW5hbHl0aWNzT2JqZWN0LmhlYWRlcnMsIGl0ZW0pXVxuICAgICAgICAgICAgLmNvbHVtblxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRhYmxlQ29uZmlndXJhdGlvbi5yb3dzKSB7XG4gICAgICAgIHRhYmxlLnRpdGxlcy5yb3dzLnB1c2goXG4gICAgICAgICAgYW5hbHl0aWNzT2JqZWN0LmhlYWRlcnNbZ2V0VGl0bGVJbmRleChhbmFseXRpY3NPYmplY3QuaGVhZGVycywgaXRlbSldXG4gICAgICAgICAgICAuY29sdW1uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3QgY29sdW1uSXRlbSBvZiB0YWJsZUNvbmZpZ3VyYXRpb24uY29sdW1ucykge1xuICAgICAgY29uc3QgZGltZW5zaW9uID0gY2FsY3VsYXRlQ29sU3BhbihcbiAgICAgICAgYW5hbHl0aWNzT2JqZWN0LFxuICAgICAgICB0YWJsZUNvbmZpZ3VyYXRpb24uY29sdW1ucyxcbiAgICAgICAgY29sdW1uSXRlbVxuICAgICAgKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRDb2x1bW5JdGVtcyA9IHByZXBhcmVTaW5nbGVDYXRlZ29yaWVzKFxuICAgICAgICBhbmFseXRpY3NPYmplY3QsXG4gICAgICAgIGNvbHVtbkl0ZW1cbiAgICAgICk7XG4gICAgICBjb25zdCBoZWFkZXJJdGVtID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpbWVuc2lvbi5kdXBsaWNhdGlvbjsgaSsrKSB7XG4gICAgICAgIGZvciAoY29uc3QgY3VycmVudEl0ZW0gb2YgY3VycmVudENvbHVtbkl0ZW1zKSB7XG4gICAgICAgICAgaGVhZGVySXRlbS5wdXNoKHtcbiAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRJdGVtLm5hbWUsXG4gICAgICAgICAgICBzcGFuOiBkaW1lbnNpb24uY29sX3NwYW4sXG4gICAgICAgICAgICB0eXBlOiBjdXJyZW50SXRlbS50eXBlLFxuICAgICAgICAgICAgaWQ6IGN1cnJlbnRJdGVtLnVpZFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsZXQgc3R5bGVzID0gJyc7XG4gICAgICBpZiAodGFibGVDb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KCdzdHlsZScpKSB7XG4gICAgICAgIGlmICh0YWJsZUNvbmZpZ3VyYXRpb24uc3R5bGVzLmhhc093blByb3BlcnR5KGNvbHVtbkl0ZW0pKSB7XG4gICAgICAgICAgc3R5bGVzID0gdGFibGVDb25maWd1cmF0aW9uLnN0eWxlc1tjb2x1bW5JdGVtXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGFibGUuaGVhZGVycy5wdXNoKHsgaXRlbXM6IGhlYWRlckl0ZW0sIHN0eWxlOiBzdHlsZXMgfSk7XG4gICAgfVxuICAgIGZvciAoY29uc3Qgcm93SXRlbSBvZiB0YWJsZUNvbmZpZ3VyYXRpb24ucm93cykge1xuICAgICAgdGFibGUuY29sdW1ucy5wdXNoKHJvd0l0ZW0pO1xuICAgIH1cblxuICAgIC8vIFByZXBhcmluZyB0YWJsZSBjb2x1bW5zXG4gICAgY29uc3QgY29sdW1uX2xlbmd0aCA9IHRhYmxlQ29uZmlndXJhdGlvbi5jb2x1bW5zLmxlbmd0aDtcbiAgICBjb25zdCBjb2x1bW5faXRlbXNfYXJyYXkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbHVtbl9sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgY3VycmVudFJvd0l0ZW1zID0gcHJlcGFyZVNpbmdsZUNhdGVnb3JpZXMoXG4gICAgICAgIGFuYWx5dGljc09iamVjdCxcbiAgICAgICAgdGFibGVDb25maWd1cmF0aW9uLmNvbHVtbnNbaV1cbiAgICAgICk7XG4gICAgICBjb2x1bW5faXRlbXNfYXJyYXkucHVzaChjdXJyZW50Um93SXRlbXMpO1xuICAgIH1cbiAgICBsZXQgdGFibGVfY29sdW1uc19hcnJheSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29sdW1uX2l0ZW1zX2FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGFibGVfY29sdW1uc19hcnJheS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGNvbHVtbl9pdGVtc19hcnJheVtpXSkge1xuICAgICAgICAgIHRhYmxlX2NvbHVtbnNfYXJyYXkucHVzaChbaXRlbV0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCB0ZW1wX2FyciA9IHRhYmxlX2NvbHVtbnNfYXJyYXkuY29uY2F0KCk7XG4gICAgICAgIHRhYmxlX2NvbHVtbnNfYXJyYXkgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRlbXBfYXJyKSB7XG4gICAgICAgICAgZm9yIChjb25zdCB2YWwgb2YgY29sdW1uX2l0ZW1zX2FycmF5W2ldKSB7XG4gICAgICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgIGNvbnN0IHRlbXBBcnIgPSBBcnJheS5mcm9tKGl0ZW0pO1xuICAgICAgICAgICAgICB0YWJsZV9jb2x1bW5zX2FycmF5LnB1c2godGVtcEFyci5jb25jYXQoW3ZhbF0pKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRhYmxlX2NvbHVtbnNfYXJyYXkucHVzaChbaXRlbSwgdmFsXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUHJlcGFyaW5nIHRhYmxlIHJvd3NcbiAgICBjb25zdCByb3dzX2xlbmd0aCA9IHRhYmxlQ29uZmlndXJhdGlvbi5yb3dzLmxlbmd0aDtcbiAgICBjb25zdCByb3dfaXRlbXNfYXJyYXkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvd3NfbGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGRpbWVuc2lvbiA9IGNhbGN1bGF0ZUNvbFNwYW4oXG4gICAgICAgIGFuYWx5dGljc09iamVjdCxcbiAgICAgICAgdGFibGVDb25maWd1cmF0aW9uLnJvd3MsXG4gICAgICAgIHRhYmxlQ29uZmlndXJhdGlvbi5yb3dzW2ldXG4gICAgICApO1xuICAgICAgY29uc3QgY3VycmVudFJvd0l0ZW1zID0gcHJlcGFyZVNpbmdsZUNhdGVnb3JpZXMoXG4gICAgICAgIGFuYWx5dGljc09iamVjdCxcbiAgICAgICAgdGFibGVDb25maWd1cmF0aW9uLnJvd3NbaV1cbiAgICAgICk7XG4gICAgICByb3dfaXRlbXNfYXJyYXkucHVzaCh7IGl0ZW1zOiBjdXJyZW50Um93SXRlbXMsIGRpbWVuc2lvbnM6IGRpbWVuc2lvbiB9KTtcbiAgICB9XG4gICAgbGV0IHRhYmxlX3Jvd3NfYXJyYXkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvd19pdGVtc19hcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRhYmxlX3Jvd3NfYXJyYXkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiByb3dfaXRlbXNfYXJyYXlbaV0uaXRlbXMpIHtcbiAgICAgICAgICBpdGVtLmRpbWVuc2lvbnMgPSByb3dfaXRlbXNfYXJyYXlbaV0uZGltZW5zaW9ucztcbiAgICAgICAgICB0YWJsZV9yb3dzX2FycmF5LnB1c2goW2l0ZW1dKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgdGVtcF9hcnIgPSB0YWJsZV9yb3dzX2FycmF5LmNvbmNhdCgpO1xuICAgICAgICB0YWJsZV9yb3dzX2FycmF5ID0gW107XG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0ZW1wX2Fycikge1xuICAgICAgICAgIGZvciAoY29uc3QgdmFsIG9mIHJvd19pdGVtc19hcnJheVtpXS5pdGVtcykge1xuICAgICAgICAgICAgdmFsLmRpbWVuc2lvbnMgPSByb3dfaXRlbXNfYXJyYXlbaV0uZGltZW5zaW9ucztcbiAgICAgICAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgY29uc3QgdGVtcEFyciA9IEFycmF5LmZyb20oaXRlbSk7XG4gICAgICAgICAgICAgIHRhYmxlX3Jvd3NfYXJyYXkucHVzaCh0ZW1wQXJyLmNvbmNhdChbdmFsXSkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGFibGVfcm93c19hcnJheS5wdXNoKFtpdGVtLCB2YWxdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgY291bnRlciA9IDA7XG4gICAgaWYgKHRhYmxlX3Jvd3NfYXJyYXkubGVuZ3RoICE9PSAwKSB7XG4gICAgICBmb3IgKGNvbnN0IHJvd0l0ZW0gb2YgdGFibGVfcm93c19hcnJheSkge1xuICAgICAgICBjb25zdCBpdGVtID0ge1xuICAgICAgICAgIGl0ZW1zOiBbXSxcbiAgICAgICAgICBoZWFkZXJzOiByb3dJdGVtXG4gICAgICAgIH07XG4gICAgICAgIGZvciAoY29uc3QgdmFsIG9mIHJvd0l0ZW0pIHtcbiAgICAgICAgICBpZiAoY291bnRlciA9PT0gMCB8fCBjb3VudGVyICUgdmFsLmRpbWVuc2lvbnMuY29sX3NwYW4gPT09IDApIHtcbiAgICAgICAgICAgIGl0ZW0uaXRlbXMucHVzaCh7XG4gICAgICAgICAgICAgIHR5cGU6IHZhbC50eXBlLFxuICAgICAgICAgICAgICBuYW1lOiB2YWwudWlkLFxuICAgICAgICAgICAgICB2YWw6IHZhbC5uYW1lLFxuICAgICAgICAgICAgICByb3dfc3BhbjogdmFsLmRpbWVuc2lvbnMuY29sX3NwYW4sXG4gICAgICAgICAgICAgIGhlYWRlcjogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgY29sSXRlbSBvZiB0YWJsZV9jb2x1bW5zX2FycmF5KSB7XG4gICAgICAgICAgY29uc3QgZGF0YUl0ZW0gPSBbXTtcbiAgICAgICAgICBmb3IgKGNvbnN0IHZhbCBvZiByb3dJdGVtKSB7XG4gICAgICAgICAgICBkYXRhSXRlbS5wdXNoKHsgdHlwZTogdmFsLnR5cGUsIHZhbHVlOiB2YWwudWlkIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmb3IgKGNvbnN0IHZhbCBvZiBjb2xJdGVtKSB7XG4gICAgICAgICAgICBkYXRhSXRlbS5wdXNoKHsgdHlwZTogdmFsLnR5cGUsIHZhbHVlOiB2YWwudWlkIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpdGVtLml0ZW1zLnB1c2goe1xuICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICB2YWw6IGdldERhdGFWYWx1ZShhbmFseXRpY3NPYmplY3QsIGRhdGFJdGVtKSxcbiAgICAgICAgICAgIGNvbG9yOiBnZXREYXRhVmFsdWVDb2xvcihcbiAgICAgICAgICAgICAgbGVnZW5kQ2xhc3NlcyxcbiAgICAgICAgICAgICAgZ2V0RGF0YVZhbHVlKGFuYWx5dGljc09iamVjdCwgZGF0YUl0ZW0pXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgcm93X3NwYW46ICcxJyxcbiAgICAgICAgICAgIGRpc3BsYXk6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXG4gICAgICAgICAgdGFibGVDb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KCdoaWRlRW1wdHlSb3dzJykgJiZcbiAgICAgICAgICB0YWJsZUNvbmZpZ3VyYXRpb24uaGlkZUVtcHR5Um93c1xuICAgICAgICApIHtcbiAgICAgICAgICBpZiAoIWNoZWNrWmVyb3ModGFibGVDb25maWd1cmF0aW9uLnJvd3MubGVuZ3RoLCBpdGVtLml0ZW1zKSkge1xuICAgICAgICAgICAgdGFibGUucm93cy5wdXNoKGl0ZW0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0YWJsZS5yb3dzLnB1c2goaXRlbSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb3VudGVyKys7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSB7XG4gICAgICAgIGl0ZW1zOiBbXSxcbiAgICAgICAgaGVhZGVyczogW11cbiAgICAgIH07XG4gICAgICBmb3IgKGNvbnN0IGNvbEl0ZW0gb2YgdGFibGVfY29sdW1uc19hcnJheSkge1xuICAgICAgICBjb25zdCBkYXRhSXRlbSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHZhbCBvZiBjb2xJdGVtKSB7XG4gICAgICAgICAgZGF0YUl0ZW0ucHVzaCh7IHR5cGU6IHZhbC50eXBlLCB2YWx1ZTogdmFsLnVpZCB9KTtcbiAgICAgICAgfVxuICAgICAgICBpdGVtLml0ZW1zLnB1c2goe1xuICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgIHZhbDogZ2V0RGF0YVZhbHVlKGFuYWx5dGljc09iamVjdCwgZGF0YUl0ZW0pLFxuICAgICAgICAgIHJvd19zcGFuOiAnMScsXG4gICAgICAgICAgZGlzcGxheTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChcbiAgICAgICAgdGFibGVDb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KCdoaWRlRW1wdHlSb3dzJykgJiZcbiAgICAgICAgdGFibGVDb25maWd1cmF0aW9uLmhpZGVFbXB0eVJvd3NcbiAgICAgICkge1xuICAgICAgICBpZiAoIWNoZWNrWmVyb3ModGFibGVDb25maWd1cmF0aW9uLnJvd3MubGVuZ3RoLCBpdGVtLml0ZW1zKSkge1xuICAgICAgICAgIHRhYmxlLnJvd3MucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGFibGUucm93cy5wdXNoKGl0ZW0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIHRvZG8gaW1wcm92ZSB0b3RhbCBvcHRpb25zIHRvIGFsc28gd29yayBmb3IgZXZlbnQgdGFibGVcbiAgLy8gcmV0dXJuIF9nZXRTYW5pdGl6ZWRUYWJsZU9iamVjdCh0YWJsZSwgdGFibGVDb25maWd1cmF0aW9uKTtcbiAgcmV0dXJuIHRhYmxlO1xufVxuXG5mdW5jdGlvbiBnZXRUaXRsZUluZGV4KGFuYWx5dGljc09iamVjdEhlYWRlcnMsIG5hbWU6IHN0cmluZykge1xuICBsZXQgaW5kZXggPSAwO1xuICBsZXQgY291bnRlciA9IDA7XG4gIGZvciAoY29uc3QgaGVhZGVyIG9mIGFuYWx5dGljc09iamVjdEhlYWRlcnMpIHtcbiAgICBpZiAoaGVhZGVyLm5hbWUgPT09IG5hbWUpIHtcbiAgICAgIGluZGV4ID0gY291bnRlcjtcbiAgICB9XG4gICAgY291bnRlcisrO1xuICB9XG4gIHJldHVybiBpbmRleDtcbn1cblxuZnVuY3Rpb24gY2FsY3VsYXRlQ29sU3BhbihhbmFseXRpY3NPYmplY3QsIGFycmF5LCBpdGVtKSB7XG4gIGNvbnN0IGluZGV4T2ZJdGVtID0gYXJyYXkuaW5kZXhPZihpdGVtKTtcbiAgY29uc3QgYXJyYXlfbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICBjb25zdCBsYXN0X2luZGV4ID0gYXJyYXlfbGVuZ3RoIC0gMTtcbiAgY29uc3QgZGltZW5zaW9ucyA9IHsgY29sX3NwYW46IDEsIGR1cGxpY2F0aW9uOiAxIH07XG4gIGZvciAobGV0IGkgPSBsYXN0X2luZGV4OyBpID4gaW5kZXhPZkl0ZW07IGktLSkge1xuICAgIGNvbnN0IGFyciA9IHByZXBhcmVTaW5nbGVDYXRlZ29yaWVzKGFuYWx5dGljc09iamVjdCwgYXJyYXlbaV0pO1xuICAgIGRpbWVuc2lvbnMuY29sX3NwYW4gPSBkaW1lbnNpb25zLmNvbF9zcGFuICogYXJyLmxlbmd0aDtcbiAgfVxuICBmb3IgKGxldCBpID0gMDsgaSA8IGluZGV4T2ZJdGVtOyBpKyspIHtcbiAgICBjb25zdCBhcnIgPSBwcmVwYXJlU2luZ2xlQ2F0ZWdvcmllcyhhbmFseXRpY3NPYmplY3QsIGFycmF5W2ldKTtcbiAgICBkaW1lbnNpb25zLmR1cGxpY2F0aW9uID0gZGltZW5zaW9ucy5kdXBsaWNhdGlvbiAqIGFyci5sZW5ndGg7XG4gIH1cbiAgcmV0dXJuIGRpbWVuc2lvbnM7XG59XG5cbmZ1bmN0aW9uIHByZXBhcmVTaW5nbGVDYXRlZ29yaWVzKFxuICBpbml0aWFsQW5hbHl0aWNzLFxuICBpdGVtSWRlbnRpZmllcixcbiAgcHJlRGVmaW5lZEl0ZW1zID0gW11cbikge1xuICBjb25zdCBhbmFseXRpY3NPYmplY3QgPSBzYW5pdGl6ZUluY29taW5nQW5hbHl0aWNzKGluaXRpYWxBbmFseXRpY3MpO1xuICBjb25zdCBzdHJ1Y3R1cmUgPSBbXTtcbiAgaWYgKHByZURlZmluZWRJdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICBmb3IgKGNvbnN0IHZhbCBvZiBnZXRNZXRhZGF0YUFycmF5KGFuYWx5dGljc09iamVjdCwgaXRlbUlkZW50aWZpZXIpKSB7XG4gICAgICBzdHJ1Y3R1cmUucHVzaCh7XG4gICAgICAgIG5hbWU6IGFuYWx5dGljc09iamVjdC5tZXRhRGF0YS5uYW1lc1t2YWxdLFxuICAgICAgICB1aWQ6IHZhbCxcbiAgICAgICAgdHlwZTogaXRlbUlkZW50aWZpZXJcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBpZiAocHJlRGVmaW5lZEl0ZW1zLmxlbmd0aCAhPT0gMCkge1xuICAgIGZvciAoY29uc3QgdmFsIG9mIHByZURlZmluZWRJdGVtcykge1xuICAgICAgc3RydWN0dXJlLnB1c2goe1xuICAgICAgICBuYW1lOiBhbmFseXRpY3NPYmplY3QubWV0YURhdGEubmFtZXNbdmFsXSxcbiAgICAgICAgdWlkOiB2YWwsXG4gICAgICAgIHR5cGU6IGl0ZW1JZGVudGlmaWVyXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHN0cnVjdHVyZTtcbn1cblxuZnVuY3Rpb24gc2FuaXRpemVJbmNvbWluZ0FuYWx5dGljcyhhbmFseXRpY3NPYmplY3Q6IGFueSkge1xuICByZXR1cm4gYW5hbHl0aWNzT2JqZWN0O1xufVxuXG5mdW5jdGlvbiBnZXRNZXRhZGF0YUFycmF5KGFuYWx5dGljc09iamVjdCwgbWV0YWRhdGFUeXBlOiBzdHJpbmcpIHtcbiAgbGV0IG1ldGFkYXRhQXJyYXkgPSBbXTtcbiAgaWYgKG1ldGFkYXRhVHlwZSA9PT0gJ2R4Jykge1xuICAgIG1ldGFkYXRhQXJyYXkgPSBhbmFseXRpY3NPYmplY3QubWV0YURhdGEuZHg7XG4gIH0gZWxzZSBpZiAobWV0YWRhdGFUeXBlID09PSAnb3UnKSB7XG4gICAgbWV0YWRhdGFBcnJheSA9IGFuYWx5dGljc09iamVjdC5tZXRhRGF0YS5vdTtcbiAgfSBlbHNlIGlmIChtZXRhZGF0YVR5cGUgPT09ICdjbycpIHtcbiAgICBtZXRhZGF0YUFycmF5ID0gYW5hbHl0aWNzT2JqZWN0Lm1ldGFEYXRhLmNvO1xuICB9IGVsc2UgaWYgKG1ldGFkYXRhVHlwZSA9PT0gJ3BlJykge1xuICAgIG1ldGFkYXRhQXJyYXkgPSBhbmFseXRpY3NPYmplY3QubWV0YURhdGEucGU7XG4gIH0gZWxzZSB7XG4gICAgbWV0YWRhdGFBcnJheSA9IGFuYWx5dGljc09iamVjdC5tZXRhRGF0YVttZXRhZGF0YVR5cGVdO1xuICB9XG4gIHJldHVybiBtZXRhZGF0YUFycmF5O1xufVxuXG5mdW5jdGlvbiBnZXREYXRhVmFsdWUoYW5hbHl0aWNzT2JqZWN0LCBkYXRhSXRlbXMgPSBbXSkge1xuICBsZXQgbnVtID0gbnVsbDtcbiAgZm9yIChjb25zdCB2YWx1ZSBvZiBhbmFseXRpY3NPYmplY3Qucm93cykge1xuICAgIGxldCBjb3VudGVyID0gMDtcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgZGF0YUl0ZW1zKSB7XG4gICAgICBpZiAoXG4gICAgICAgIHZhbHVlW2dldFRpdGxlSW5kZXgoYW5hbHl0aWNzT2JqZWN0LmhlYWRlcnMsIGl0ZW0udHlwZSldID09PSBpdGVtLnZhbHVlXG4gICAgICApIHtcbiAgICAgICAgY291bnRlcisrO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY291bnRlciA9PT0gZGF0YUl0ZW1zLmxlbmd0aCkge1xuICAgICAgaWYgKGlzTmFOKHZhbHVlW2dldFRpdGxlSW5kZXgoYW5hbHl0aWNzT2JqZWN0LmhlYWRlcnMsICd2YWx1ZScpXSkpIHtcbiAgICAgICAgbnVtID0gdmFsdWVbZ2V0VGl0bGVJbmRleChhbmFseXRpY3NPYmplY3QuaGVhZGVycywgJ3ZhbHVlJyldO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbnVtICs9IHBhcnNlRmxvYXQoXG4gICAgICAgICAgdmFsdWVbZ2V0VGl0bGVJbmRleChhbmFseXRpY3NPYmplY3QuaGVhZGVycywgJ3ZhbHVlJyldXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBudW07XG59XG5cbmZ1bmN0aW9uIGdldERhdGFWYWx1ZUNvbG9yKGxlZ2VuZENsYXNzZXMsIHZhbHVlKSB7XG4gIGxldCBjb2xvciA9ICcnO1xuICBpZiAoIWlzTmFOKHZhbHVlKSAmJiBsZWdlbmRDbGFzc2VzKSB7XG4gICAgbGVnZW5kQ2xhc3Nlcy5mb3JFYWNoKGxlZ2VuZENsYXNzID0+IHtcbiAgICAgIGlmIChsZWdlbmRDbGFzcy5zdGFydFZhbHVlIDw9IHZhbHVlICYmIGxlZ2VuZENsYXNzLmVuZFZhbHVlID4gdmFsdWUpIHtcbiAgICAgICAgY29sb3IgPSBsZWdlbmRDbGFzcy5jb2xvcjtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgKGxlZ2VuZENsYXNzLnN0YXJ0VmFsdWUgPCB2YWx1ZSAmJiBsZWdlbmRDbGFzcy5lbmRWYWx1ZSA+PSB2YWx1ZSkge1xuICAgICAgXG4gICAgICAvLyB9XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGNvbG9yO1xufVxuXG5mdW5jdGlvbiBjaGVja1plcm9zKHN0YXRpbmdfbGVuZ3RoLCBhcnJheSk6IGJvb2xlYW4ge1xuICBsZXQgY2hlY2tlciA9IHRydWU7XG4gIGZvciAobGV0IGkgPSBzdGF0aW5nX2xlbmd0aDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGFycmF5W2ldLm5hbWUgPT09ICcnICYmIGFycmF5W2ldLnZhbCAhPSBudWxsKSB7XG4gICAgICBjaGVja2VyID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiBjaGVja2VyO1xufVxuIiwiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBUYWJsZUNvbmZpZ3VyYXRpb24gfSBmcm9tICcuLi8uLi9tb2RlbHMvdGFibGUtY29uZmlndXJhdGlvbic7XG5cbmltcG9ydCB7IGdldFRhYmxlQ29uZmlndXJhdGlvbiB9IGZyb20gJy4uLy4uL2hlbHBlcnMvaW5kZXgnO1xuQENvbXBvbmVudCh7XG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgc2VsZWN0b3I6ICduZ3gtZGhpczItdGFibGUtbGlzdCcsXG4gIHRlbXBsYXRlOiBgPGRpdiBjbGFzcz1cInJvd1wiPlxuICAgIDxkaXYgY2xhc3M9XCJjb2wtMTJcIiAqbmdGb3I9XCJsZXQgdGFibGVMYXllciBvZiB0YWJsZUxheWVyc1wiPlxuICAgICAgICA8bmd4LWRoaXMyLXRhYmxlLWl0ZW0gW2FuYWx5dGljc09iamVjdF09XCJ0YWJsZUxheWVyLmFuYWx5dGljc09iamVjdFwiIFt0YWJsZUNvbmZpZ3VyYXRpb25dPVwidGFibGVMYXllci50YWJsZUNvbmZpZ3VyYXRpb25cIj5cbiAgICAgICAgPC9uZ3gtZGhpczItdGFibGUtaXRlbT5cbiAgICA8L2Rpdj5cbjwvZGl2PmAsXG4gIHN0eWxlczogW2BgXVxufSlcbmV4cG9ydCBjbGFzcyBUYWJsZUxpc3RDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBASW5wdXQoKSB2aXN1YWxpemF0aW9uTGF5ZXJzOiBhbnlbXTtcbiAgQElucHV0KCkgdmlzdWFsaXphdGlvblR5cGU6IHN0cmluZztcbiAgdGFibGVMYXllcnM6IEFycmF5PHtcbiAgICB0YWJsZUNvbmZpZ3VyYXRpb246IFRhYmxlQ29uZmlndXJhdGlvbjtcbiAgICBhbmFseXRpY3NPYmplY3Q6IGFueTtcbiAgfT4gPSBbXTtcbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGlmICh0aGlzLnZpc3VhbGl6YXRpb25MYXllcnMgJiYgdGhpcy52aXN1YWxpemF0aW9uTGF5ZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMudGFibGVMYXllcnMgPSB0aGlzLnZpc3VhbGl6YXRpb25MYXllcnMubWFwKChsYXllcjogYW55KSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdGFibGVDb25maWd1cmF0aW9uOiBnZXRUYWJsZUNvbmZpZ3VyYXRpb24oXG4gICAgICAgICAgICBsYXllci5jb25maWcgfHwge30sXG4gICAgICAgICAgICBsYXllci5sYXlvdXQsXG4gICAgICAgICAgICB0aGlzLnZpc3VhbGl6YXRpb25UeXBlXG4gICAgICAgICAgKSxcbiAgICAgICAgICBhbmFseXRpY3NPYmplY3Q6IGxheWVyLmFuYWx5dGljc1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFRhYmxlQ29uZmlndXJhdGlvbiB9IGZyb20gJy4uLy4uL21vZGVscy90YWJsZS1jb25maWd1cmF0aW9uJztcblxuaW1wb3J0IHsgZHJhd1RhYmxlIH0gZnJvbSAnLi4vLi4vaGVscGVycy9pbmRleCc7XG5cbkBDb21wb25lbnQoe1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29tcG9uZW50LXNlbGVjdG9yXG4gIHNlbGVjdG9yOiAnbmd4LWRoaXMyLXRhYmxlLWl0ZW0nLFxuICB0ZW1wbGF0ZTogYDxkaXYgY2xhc3M9XCJyb3dcIj5cbiAgICA8ZGl2IGNsYXNzPVwiY29sLW1kLTEyXCIgKm5nSWY9XCJ0YWJsZU9iamVjdFwiPlxuICAgICAgICA8aDUgc3R5bGU9XCJtYXJnaW4tdG9wOiA4MHB4XCIgY2xhc3M9XCJ0ZXh0LWNlbnRlclwiICpuZ0lmPVwidGFibGVPYmplY3Qucm93cy5sZW5ndGggPT0gMFwiPiBObyBkYXRhIHRvIGRpc3BsYXk8L2g1PlxuXG4gICAgICAgIDxkaXYgKm5nSWY9XCJ0YWJsZU9iamVjdFwiIHN0eWxlPVwicGFkZGluZzogM3B4XCI+XG4gICAgICAgICAgICA8IS0tPGg0ICpuZ0lmPVwidGFibGVPYmplY3Qucm93cy5sZW5ndGggIT0gMFwiIGNsYXNzPVwidGV4dC1jZW50ZXJcIiBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDBweFwiPnt7dGFibGVPYmplY3Q/LnRpdGxlfX08L2g0Pi0tPlxuICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVwidGFibGUgdGFibGUtYm9yZGVyZWQgdGFibGUtcmVzcG9uc2l2ZSB0YWJsZS1jb25kZW5zZWQgY3VzdG9tLXRhYmxlXCIgKm5nSWY9XCJ0YWJsZU9iamVjdC5yb3dzLmxlbmd0aCAhPSAwXCI+XG4gICAgICAgICAgICAgICAgPHRoZWFkPlxuICAgICAgICAgICAgICAgICAgICA8IS0tdGl0bGUtLT5cbiAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPVwidGFibGUtdGl0bGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBbYXR0ci5jb2xzcGFuXT1cInRhYmxlT2JqZWN0LnJvd3NbMF0uaXRlbXMubGVuZ3RoXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg0IHN0eWxlPVwibWFyZ2luOiAwcHhcIiBjbGFzcz1cInRleHQtY2VudGVyXCI+e3t0YWJsZU9iamVjdC5zdWJ0aXRsZX19IDwvaDQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICA8IS0taGVhZGVycy0tPlxuICAgICAgICAgICAgICAgICAgICA8dHIgKm5nRm9yPVwibGV0IGhlYWRlciBvZiB0YWJsZU9iamVjdC5oZWFkZXJzOyBsZXQgaiA9IGluZGV4XCIgY2xhc3M9XCJoZWFkZXItY29sdW1uXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGggKm5nSWY9XCJ0YWJsZU9iamVjdC5oYXNQYXJlbnRPdVwiPjwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGggKm5nRm9yPVwibGV0IHRhYmxlX2NvbHVtbiBvZiB0YWJsZU9iamVjdC5jb2x1bW5zOyBsZXQgaSA9IGluZGV4XCIgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cImk9PXRhYmxlT2JqZWN0LmNvbHVtbnMubGVuZ3RoLTEgJiYgaj09dGFibGVPYmplY3QuaGVhZGVycy5sZW5ndGgtMSAmJiB0YWJsZU9iamVjdC50aXRsZXNBdmFpbGFibGVcIj57eyB0YWJsZU9iamVjdC50aXRsZXMucm93c1tpXSB9fSAvIHt7IHRhYmxlT2JqZWN0LnRpdGxlcy5jb2x1bW5bal19fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cImkgIT0gdGFibGVPYmplY3QuY29sdW1ucy5sZW5ndGgtMVwiPnt7IHRhYmxlT2JqZWN0LnRpdGxlcy5yb3dzW2ldIH19PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwiaiAhPSB0YWJsZU9iamVjdC5oZWFkZXJzLmxlbmd0aC0xXCI+e3sgdGFibGVPYmplY3QudGl0bGVzLmNvbHVtbltqXSB9fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGggKm5nRm9yPVwibGV0IGhlYWRlcl9jb2x1bW4gb2YgaGVhZGVyLml0ZW1zOyBsZXQgaT1pbmRleFwiIFtjb2xTcGFuXT1cImhlYWRlcl9jb2x1bW4uc3BhblwiIHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyXCIgKGNsaWNrKT1cInNvcnREYXRhKHRhYmxlT2JqZWN0LGkrdGFibGVPYmplY3QuY29sdW1ucy5sZW5ndGgsaisxPT10YWJsZU9iamVjdC5oZWFkZXJzLmxlbmd0aClcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyBoZWFkZXJfY29sdW1uLm5hbWUgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cImorMT09dGFibGVPYmplY3QuaGVhZGVycy5sZW5ndGggJiYgY3VycmVudF9zb3J0aW5nW2krdGFibGVPYmplY3QuY29sdW1ucy5sZW5ndGhdICYmIHNvcnRfZGlyZWN0aW9uW2krdGFibGVPYmplY3QuY29sdW1ucy5sZW5ndGhdID09ICdhc2MnXCIgY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXRyaWFuZ2xlLXRvcCBwdWxsLXJpZ2h0XCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwiaisxPT10YWJsZU9iamVjdC5oZWFkZXJzLmxlbmd0aCAmJiBjdXJyZW50X3NvcnRpbmdbaSt0YWJsZU9iamVjdC5jb2x1bW5zLmxlbmd0aF0gJiYgc29ydF9kaXJlY3Rpb25baSt0YWJsZU9iamVjdC5jb2x1bW5zLmxlbmd0aF0gPT0gJ2Rlc2MnXCIgY2xhc3M9XCJnbHlwaGljb24gZ2x5cGhpY29uLXRyaWFuZ2xlLWJvdHRvbSBwdWxsLXJpZ2h0XCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgICAgICAgIDx0Ym9keSBpZD1cIm15UGl2b3RUYWJsZVwiPlxuICAgICAgICAgICAgICAgICAgICA8dHIgKm5nRm9yPVwibGV0IHJvdyBvZiB0YWJsZU9iamVjdC5yb3dzXCIgW25nQ2xhc3NdPVwieydzdWItdG90YWwnOiByb3cuc3ViX3RvdGFsfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRkICpuZ0Zvcj1cImxldCBoZWFkZXJfY29sdW1uIG9mIHJvdy5pdGVtcztsZXQgaSA9IGluZGV4XCIgW25nQ2xhc3NdPVwieydoZWFkZXItY29sdW1uJzogaGVhZGVyX2NvbHVtbi5uYW1lICE9ICcnfVwiIHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyO3ZlcnRpY2FsLWFsaWduOiBtaWRkbGVcIiBbYXR0ci5yb3dzcGFuXT1cImhlYWRlcl9jb2x1bW4ucm93X3NwYW5cIiBbc3R5bGUuYmFja2dyb3VuZF09XCJoZWFkZXJfY29sdW1uLmNvbG9yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgaGVhZGVyX2NvbHVtbi52YWwgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgICAgIDwvdGFibGU+XG5cblxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbjwvZGl2PmAsXG4gIHN0eWxlczogW2AudGFibGUtaXRlbS1jb250YWluZXJ7b3ZlcmZsb3c6aGlkZGVufS5jdXN0b20tdGFibGV7ZGlzcGxheTp0YWJsZTtib3JkZXItc3R5bGU6bm9uZSFpbXBvcnRhbnQ7d2lkdGg6MTAwJX0uY3VzdG9tLXRhYmxlIHRkLC5jdXN0b20tdGFibGUgdGh7Ym9yZGVyOnRoaW4gc29saWQgI2YxZjFmMX0uY3VzdG9tLXRhYmxlPnRib2R5PnRyPnRkLC5jdXN0b20tdGFibGU+dGhlYWQ+dHI+dGh7Zm9udC1zaXplOjEzcHghaW1wb3J0YW50fXRhYmxlIHRyIHRoe2JhY2tncm91bmQtY29sb3I6cmdiYSgyMzgsMjM4LDIzOCwuMjkpO3BhZGRpbmc6NHB4O3RleHQtYWxpZ246Y2VudGVyfXRhYmxlIHRyIHRke3BhZGRpbmc6NHB4fXRhYmxlIHRyIHRkOmZpcnN0LWNoaWxke2JhY2tncm91bmQtY29sb3I6cmdiYSgyMzgsMjM4LDIzOCwuMjkpfS50YWJsZS10aXRsZXtmb250LXNpemU6MTNweDtmb250LXdlaWdodDo2MDA7dGV4dC1hbGlnbjpjZW50ZXJ9YF1cbn0pXG5leHBvcnQgY2xhc3MgVGFibGVJdGVtQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KCkgdGFibGVDb25maWd1cmF0aW9uOiBUYWJsZUNvbmZpZ3VyYXRpb247XG4gIEBJbnB1dCgpIGFuYWx5dGljc09iamVjdDogYW55O1xuICB0YWJsZU9iamVjdDogYW55O1xuICBzb3J0X2RpcmVjdGlvbjogc3RyaW5nW10gPSBbXTtcbiAgY3VycmVudF9zb3J0aW5nOiBib29sZWFuW10gPSBbXTtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy50YWJsZU9iamVjdCA9IG51bGw7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBpZiAodGhpcy5hbmFseXRpY3NPYmplY3QgJiYgdGhpcy50YWJsZUNvbmZpZ3VyYXRpb24pIHtcbiAgICAgIHRoaXMudGFibGVPYmplY3QgPSBkcmF3VGFibGUoXG4gICAgICAgIHRoaXMuYW5hbHl0aWNzT2JqZWN0LFxuICAgICAgICB0aGlzLnRhYmxlQ29uZmlndXJhdGlvblxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBzb3J0RGF0YSh0YWJsZU9iamVjdCwgbiwgaXNMYXN0SXRlbSkge1xuICAgIGlmICh0YWJsZU9iamVjdC5jb2x1bW5zLmxlbmd0aCA9PT0gMSAmJiBpc0xhc3RJdGVtKSB7XG4gICAgICB0aGlzLmN1cnJlbnRfc29ydGluZyA9IFtdO1xuICAgICAgdGhpcy5jdXJyZW50X3NvcnRpbmdbbl0gPSB0cnVlO1xuICAgICAgbGV0IHRhYmxlLFxuICAgICAgICByb3dzLFxuICAgICAgICBzd2l0Y2hpbmcsXG4gICAgICAgIGksXG4gICAgICAgIHgsXG4gICAgICAgIHksXG4gICAgICAgIHNob3VsZFN3aXRjaCxcbiAgICAgICAgZGlyLFxuICAgICAgICBzd2l0Y2hjb3VudCA9IDA7XG4gICAgICB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdteVBpdm90VGFibGUnKTtcbiAgICAgIHN3aXRjaGluZyA9IHRydWU7XG4gICAgICAvLyAgU2V0IHRoZSBzb3J0aW5nIGRpcmVjdGlvbiB0byBhc2NlbmRpbmc6XG4gICAgICBkaXIgPSAnYXNjJztcbiAgICAgIC8qTWFrZSBhIGxvb3AgdGhhdCB3aWxsIGNvbnRpbnVlIHVudGlsXG4gICAgICAgbm8gc3dpdGNoaW5nIGhhcyBiZWVuIGRvbmU6Ki9cbiAgICAgIHdoaWxlIChzd2l0Y2hpbmcpIHtcbiAgICAgICAgLy8gIHN0YXJ0IGJ5IHNheWluZzogbm8gc3dpdGNoaW5nIGlzIGRvbmU6XG4gICAgICAgIHN3aXRjaGluZyA9IGZhbHNlO1xuICAgICAgICByb3dzID0gdGFibGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ1RSJyk7XG4gICAgICAgIC8qTG9vcCB0aHJvdWdoIGFsbCB0YWJsZSByb3dzIChleGNlcHQgdGhlXG4gICAgICAgICBmaXJzdCwgd2hpY2ggY29udGFpbnMgdGFibGUgaGVhZGVycyk6Ki9cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHJvd3MubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgLy8gc3RhcnQgYnkgc2F5aW5nIHRoZXJlIHNob3VsZCBiZSBubyBzd2l0Y2hpbmc6XG4gICAgICAgICAgc2hvdWxkU3dpdGNoID0gZmFsc2U7XG4gICAgICAgICAgLypHZXQgdGhlIHR3byBlbGVtZW50cyB5b3Ugd2FudCB0byBjb21wYXJlLFxuICAgICAgICAgICBvbmUgZnJvbSBjdXJyZW50IHJvdyBhbmQgb25lIGZyb20gdGhlIG5leHQ6Ki9cbiAgICAgICAgICB4ID0gcm93c1tpXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnVEQnKVtuXTtcbiAgICAgICAgICB5ID0gcm93c1tpICsgMV0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ1REJylbbl07XG4gICAgICAgICAgLypjaGVjayBpZiB0aGUgdHdvIHJvd3Mgc2hvdWxkIHN3aXRjaCBwbGFjZSxcbiAgICAgICAgICAgYmFzZWQgb24gdGhlIGRpcmVjdGlvbiwgYXNjIG9yIGRlc2M6Ki9cbiAgICAgICAgICBpZiAoZGlyID09PSAnYXNjJykge1xuICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoeC5pbm5lckhUTUwpKSB7XG4gICAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KHguaW5uZXJIVE1MKSA+IHBhcnNlRmxvYXQoeS5pbm5lckhUTUwpKSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgc28sIG1hcmsgYXMgYSBzd2l0Y2ggYW5kIGJyZWFrIHRoZSBsb29wOlxuICAgICAgICAgICAgICAgIHNob3VsZFN3aXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmICh4LmlubmVySFRNTC50b0xvd2VyQ2FzZSgpID4geS5pbm5lckhUTUwudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIC8vIGlmIHNvLCBtYXJrIGFzIGEgc3dpdGNoIGFuZCBicmVhayB0aGUgbG9vcDpcbiAgICAgICAgICAgICAgICBzaG91bGRTd2l0Y2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNvcnRfZGlyZWN0aW9uW25dID0gJ2FzYyc7XG4gICAgICAgICAgfSBlbHNlIGlmIChkaXIgPT09ICdkZXNjJykge1xuICAgICAgICAgICAgaWYgKHBhcnNlRmxvYXQoeC5pbm5lckhUTUwpKSB7XG4gICAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KHguaW5uZXJIVE1MKSA8IHBhcnNlRmxvYXQoeS5pbm5lckhUTUwpKSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgc28sIG1hcmsgYXMgYSBzd2l0Y2ggYW5kIGJyZWFrIHRoZSBsb29wOlxuICAgICAgICAgICAgICAgIHNob3VsZFN3aXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGlmICh4LmlubmVySFRNTC50b0xvd2VyQ2FzZSgpIDwgeS5pbm5lckhUTUwudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIC8vIGlmIHNvLCBtYXJrIGFzIGEgc3dpdGNoIGFuZCBicmVhayB0aGUgbG9vcDpcbiAgICAgICAgICAgICAgICBzaG91bGRTd2l0Y2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNvcnRfZGlyZWN0aW9uW25dID0gJ2Rlc2MnO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2hvdWxkU3dpdGNoKSB7XG4gICAgICAgICAgLypJZiBhIHN3aXRjaCBoYXMgYmVlbiBtYXJrZWQsIG1ha2UgdGhlIHN3aXRjaFxuICAgICAgICAgICBhbmQgbWFyayB0aGF0IGEgc3dpdGNoIGhhcyBiZWVuIGRvbmU6Ki9cbiAgICAgICAgICByb3dzW2ldLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHJvd3NbaSArIDFdLCByb3dzW2ldKTtcbiAgICAgICAgICBzd2l0Y2hpbmcgPSB0cnVlO1xuICAgICAgICAgIC8vIEVhY2ggdGltZSBhIHN3aXRjaCBpcyBkb25lLCBpbmNyZWFzZSB0aGlzIGNvdW50IGJ5IDE6XG4gICAgICAgICAgc3dpdGNoY291bnQrKztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvKklmIG5vIHN3aXRjaGluZyBoYXMgYmVlbiBkb25lIEFORCB0aGUgZGlyZWN0aW9uIGlzICdhc2MnLFxuICAgICAgICAgICBzZXQgdGhlIGRpcmVjdGlvbiB0byAnZGVzYycgYW5kIHJ1biB0aGUgd2hpbGUgbG9vcCBhZ2Fpbi4qL1xuICAgICAgICAgIGlmIChzd2l0Y2hjb3VudCA9PT0gMCAmJiBkaXIgPT09ICdhc2MnKSB7XG4gICAgICAgICAgICBkaXIgPSAnZGVzYyc7XG4gICAgICAgICAgICB0aGlzLnNvcnRfZGlyZWN0aW9uW25dID0gJ2Rlc2MnO1xuICAgICAgICAgICAgc3dpdGNoaW5nID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IE5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBUYWJsZUxpc3RDb21wb25lbnQgfSBmcm9tICcuL2NvbXBvbmVudHMvdGFibGUtbGlzdC90YWJsZS1saXN0LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBUYWJsZUl0ZW1Db21wb25lbnQgfSBmcm9tICcuL2NvbXBvbmVudHMvdGFibGUtaXRlbS90YWJsZS1pdGVtLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuXG5ATmdNb2R1bGUoe1xuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlXSxcbiAgZGVjbGFyYXRpb25zOiBbVGFibGVMaXN0Q29tcG9uZW50LCBUYWJsZUl0ZW1Db21wb25lbnRdLFxuICBleHBvcnRzOiBbVGFibGVMaXN0Q29tcG9uZW50LCBUYWJsZUl0ZW1Db21wb25lbnRdXG59KVxuZXhwb3J0IGNsYXNzIE5neERoaXMyVGFibGVNb2R1bGUge31cbiJdLCJuYW1lcyI6WyJ0c2xpYl8xLl9fdmFsdWVzIiwiQ29tcG9uZW50IiwiSW5wdXQiLCJOZ01vZHVsZSIsIkNvbW1vbk1vZHVsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUNBLG1DQUNFLGNBQW1CLEVBQ25CLG1CQUF3QixFQUN4QixJQUFZO1FBRVosT0FBTztZQUNMLEtBQUssRUFBRSxjQUFjLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQztrQkFDL0MsY0FBYyxDQUFDLFdBQVc7a0JBQzFCLGNBQWMsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDO3NCQUNuQyxjQUFjLENBQUMsSUFBSTtzQkFDbkIsRUFBRTtZQUNSLFFBQVEsRUFBRSxjQUFjLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQztrQkFDL0MsY0FBYyxDQUFDLFFBQVE7a0JBQ3ZCLEVBQUU7WUFDTixlQUFlLEVBQUUsY0FBYyxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUM7a0JBQ3RELGNBQWMsQ0FBQyxRQUFRO2tCQUN2QixJQUFJO1lBQ1Isa0JBQWtCLEVBQUUsY0FBYyxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUM7a0JBQzVELGNBQWMsQ0FBQyxXQUFXO2tCQUMxQixJQUFJO1lBQ1IsWUFBWSxFQUFFLGNBQWMsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDO2tCQUNuRCxjQUFjLENBQUMsUUFBUTtrQkFDdkIsSUFBSTtZQUNSLGVBQWUsRUFBRSxjQUFjLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQztrQkFDekQsY0FBYyxDQUFDLFdBQVc7a0JBQzFCLElBQUk7WUFDUixtQkFBbUIsRUFBRSxjQUFjLENBQUMsY0FBYyxDQUFDLHFCQUFxQixDQUFDO2tCQUNyRSxjQUFjLENBQUMsbUJBQW1CO2tCQUNsQyxJQUFJO1lBQ1IsYUFBYSxFQUFFLGNBQWMsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDO2tCQUN6RCxjQUFjLENBQUMsYUFBYTtrQkFDNUIsSUFBSTtZQUNSLGFBQWEsRUFBRSxjQUFjLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQztr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