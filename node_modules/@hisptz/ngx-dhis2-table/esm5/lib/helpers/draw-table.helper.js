/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import * as tslib_1 from "tslib";
/**
 * @param {?} analyticsObject
 * @param {?} tableConfiguration
 * @return {?}
 */
export function drawTable(analyticsObject, tableConfiguration) {
    var /** @type {?} */ legendClasses = tableConfiguration.legendSet
        ? tableConfiguration.legendSet.legends
        : null;
    var /** @type {?} */ table = {
        headers: [],
        columns: [],
        rows: [],
        titles: {
            rows: [],
            column: []
        },
        titlesAvailable: false,
        hasParentOu: false
    };
    if (tableConfiguration.hasOwnProperty('title')) {
        table['title'] = tableConfiguration.title;
    }
    if (tableConfiguration.hasOwnProperty('subtitle')) {
        table['subtitle'] = tableConfiguration.subtitle;
    }
    if (tableConfiguration.displayList) {
        table.headers[0] = {
            items: [],
            style: ''
        };
        tableConfiguration.columns[tableConfiguration.columns.indexOf('pe')] =
            'eventdate';
        tableConfiguration.columns[tableConfiguration.columns.indexOf('ou')] =
            'ouname';
        try {
            for (var _a = tslib_1.__values(tableConfiguration.columns), _b = _a.next(); !_b.done; _b = _a.next()) {
                var item = _b.value;
                table.headers[0].items.push({
                    name: analyticsObject.headers[getTitleIndex(analyticsObject.headers, item)]
                        .column,
                    span: 1
                });
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_b && !_b.done && (_c = _a.return)) _c.call(_a);
            }
            finally { if (e_1) throw e_1.error; }
        }
        try {
            for (var _d = tslib_1.__values(analyticsObject.rows), _e = _d.next(); !_e.done; _e = _d.next()) {
                var item = _e.value;
                var /** @type {?} */ column_items = [];
                try {
                    for (var _f = tslib_1.__values(tableConfiguration.columns), _g = _f.next(); !_g.done; _g = _f.next()) {
                        var col = _g.value;
                        var /** @type {?} */ index = getTitleIndex(analyticsObject.headers, col);
                        column_items.push({
                            name: '',
                            display: true,
                            row_span: '1',
                            // color:getColor(item[index],)
                            val: item[index]
                        });
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_g && !_g.done && (_h = _f.return)) _h.call(_f);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
                table.rows.push({
                    headers: [],
                    items: column_items
                });
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_e && !_e.done && (_j = _d.return)) _j.call(_d);
            }
            finally { if (e_3) throw e_3.error; }
        }
    }
    else {
        // add names to titles array
        if (tableConfiguration.showDimensionLabels) {
            table.titlesAvailable = true;
            try {
                for (var _k = tslib_1.__values(tableConfiguration.columns), _l = _k.next(); !_l.done; _l = _k.next()) {
                    var item = _l.value;
                    table.titles.column.push(analyticsObject.headers[getTitleIndex(analyticsObject.headers, item)]
                        .column);
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_l && !_l.done && (_m = _k.return)) _m.call(_k);
                }
                finally { if (e_4) throw e_4.error; }
            }
            try {
                for (var _o = tslib_1.__values(tableConfiguration.rows), _p = _o.next(); !_p.done; _p = _o.next()) {
                    var item = _p.value;
                    table.titles.rows.push(analyticsObject.headers[getTitleIndex(analyticsObject.headers, item)]
                        .column);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (_p && !_p.done && (_q = _o.return)) _q.call(_o);
                }
                finally { if (e_5) throw e_5.error; }
            }
        }
        try {
            for (var _r = tslib_1.__values(tableConfiguration.columns), _s = _r.next(); !_s.done; _s = _r.next()) {
                var columnItem = _s.value;
                var /** @type {?} */ dimension = calculateColSpan(analyticsObject, tableConfiguration.columns, columnItem);
                var /** @type {?} */ currentColumnItems = prepareSingleCategories(analyticsObject, columnItem);
                var /** @type {?} */ headerItem = [];
                for (var /** @type {?} */ i = 0; i < dimension.duplication; i++) {
                    try {
                        for (var currentColumnItems_1 = tslib_1.__values(currentColumnItems), currentColumnItems_1_1 = currentColumnItems_1.next(); !currentColumnItems_1_1.done; currentColumnItems_1_1 = currentColumnItems_1.next()) {
                            var currentItem = currentColumnItems_1_1.value;
                            headerItem.push({
                                name: currentItem.name,
                                span: dimension.col_span,
                                type: currentItem.type,
                                id: currentItem.uid
                            });
                        }
                    }
                    catch (e_6_1) { e_6 = { error: e_6_1 }; }
                    finally {
                        try {
                            if (currentColumnItems_1_1 && !currentColumnItems_1_1.done && (_t = currentColumnItems_1.return)) _t.call(currentColumnItems_1);
                        }
                        finally { if (e_6) throw e_6.error; }
                    }
                }
                var /** @type {?} */ styles = '';
                if (tableConfiguration.hasOwnProperty('style')) {
                    if (tableConfiguration.styles.hasOwnProperty(columnItem)) {
                        styles = tableConfiguration.styles[columnItem];
                    }
                }
                table.headers.push({ items: headerItem, style: styles });
            }
        }
        catch (e_7_1) { e_7 = { error: e_7_1 }; }
        finally {
            try {
                if (_s && !_s.done && (_u = _r.return)) _u.call(_r);
            }
            finally { if (e_7) throw e_7.error; }
        }
        try {
            for (var _v = tslib_1.__values(tableConfiguration.rows), _w = _v.next(); !_w.done; _w = _v.next()) {
                var rowItem = _w.value;
                table.columns.push(rowItem);
            }
        }
        catch (e_8_1) { e_8 = { error: e_8_1 }; }
        finally {
            try {
                if (_w && !_w.done && (_x = _v.return)) _x.call(_v);
            }
            finally { if (e_8) throw e_8.error; }
        }
        // Preparing table columns
        var /** @type {?} */ column_length = tableConfiguration.columns.length;
        var /** @type {?} */ column_items_array = [];
        for (var /** @type {?} */ i = 0; i < column_length; i++) {
            var /** @type {?} */ currentRowItems = prepareSingleCategories(analyticsObject, tableConfiguration.columns[i]);
            column_items_array.push(currentRowItems);
        }
        var /** @type {?} */ table_columns_array = [];
        for (var /** @type {?} */ i = 0; i < column_items_array.length; i++) {
            if (table_columns_array.length === 0) {
                try {
                    for (var _y = tslib_1.__values(column_items_array[i]), _z = _y.next(); !_z.done; _z = _y.next()) {
                        var item = _z.value;
                        table_columns_array.push([item]);
                    }
                }
                catch (e_9_1) { e_9 = { error: e_9_1 }; }
                finally {
                    try {
                        if (_z && !_z.done && (_0 = _y.return)) _0.call(_y);
                    }
                    finally { if (e_9) throw e_9.error; }
                }
            }
            else {
                var /** @type {?} */ temp_arr = table_columns_array.concat();
                table_columns_array = [];
                try {
                    for (var temp_arr_1 = tslib_1.__values(temp_arr), temp_arr_1_1 = temp_arr_1.next(); !temp_arr_1_1.done; temp_arr_1_1 = temp_arr_1.next()) {
                        var item = temp_arr_1_1.value;
                        try {
                            for (var _1 = tslib_1.__values(column_items_array[i]), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                                var val = _2.value;
                                if (item instanceof Array) {
                                    var /** @type {?} */ tempArr = Array.from(item);
                                    table_columns_array.push(tempArr.concat([val]));
                                }
                                else {
                                    table_columns_array.push([item, val]);
                                }
                            }
                        }
                        catch (e_10_1) { e_10 = { error: e_10_1 }; }
                        finally {
                            try {
                                if (_2 && !_2.done && (_3 = _1.return)) _3.call(_1);
                            }
                            finally { if (e_10) throw e_10.error; }
                        }
                    }
                }
                catch (e_11_1) { e_11 = { error: e_11_1 }; }
                finally {
                    try {
                        if (temp_arr_1_1 && !temp_arr_1_1.done && (_4 = temp_arr_1.return)) _4.call(temp_arr_1);
                    }
                    finally { if (e_11) throw e_11.error; }
                }
            }
        }
        // Preparing table rows
        var /** @type {?} */ rows_length = tableConfiguration.rows.length;
        var /** @type {?} */ row_items_array = [];
        for (var /** @type {?} */ i = 0; i < rows_length; i++) {
            var /** @type {?} */ dimension = calculateColSpan(analyticsObject, tableConfiguration.rows, tableConfiguration.rows[i]);
            var /** @type {?} */ currentRowItems = prepareSingleCategories(analyticsObject, tableConfiguration.rows[i]);
            row_items_array.push({ items: currentRowItems, dimensions: dimension });
        }
        var /** @type {?} */ table_rows_array = [];
        for (var /** @type {?} */ i = 0; i < row_items_array.length; i++) {
            if (table_rows_array.length === 0) {
                try {
                    for (var _5 = tslib_1.__values(row_items_array[i].items), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                        var item = _6.value;
                        item.dimensions = row_items_array[i].dimensions;
                        table_rows_array.push([item]);
                    }
                }
                catch (e_12_1) { e_12 = { error: e_12_1 }; }
                finally {
                    try {
                        if (_6 && !_6.done && (_7 = _5.return)) _7.call(_5);
                    }
                    finally { if (e_12) throw e_12.error; }
                }
            }
            else {
                var /** @type {?} */ temp_arr = table_rows_array.concat();
                table_rows_array = [];
                try {
                    for (var temp_arr_2 = tslib_1.__values(temp_arr), temp_arr_2_1 = temp_arr_2.next(); !temp_arr_2_1.done; temp_arr_2_1 = temp_arr_2.next()) {
                        var item = temp_arr_2_1.value;
                        try {
                            for (var _8 = tslib_1.__values(row_items_array[i].items), _9 = _8.next(); !_9.done; _9 = _8.next()) {
                                var val = _9.value;
                                val.dimensions = row_items_array[i].dimensions;
                                if (item instanceof Array) {
                                    var /** @type {?} */ tempArr = Array.from(item);
                                    table_rows_array.push(tempArr.concat([val]));
                                }
                                else {
                                    table_rows_array.push([item, val]);
                                }
                            }
                        }
                        catch (e_13_1) { e_13 = { error: e_13_1 }; }
                        finally {
                            try {
                                if (_9 && !_9.done && (_10 = _8.return)) _10.call(_8);
                            }
                            finally { if (e_13) throw e_13.error; }
                        }
                    }
                }
                catch (e_14_1) { e_14 = { error: e_14_1 }; }
                finally {
                    try {
                        if (temp_arr_2_1 && !temp_arr_2_1.done && (_11 = temp_arr_2.return)) _11.call(temp_arr_2);
                    }
                    finally { if (e_14) throw e_14.error; }
                }
            }
        }
        var /** @type {?} */ counter = 0;
        if (table_rows_array.length !== 0) {
            try {
                for (var table_rows_array_1 = tslib_1.__values(table_rows_array), table_rows_array_1_1 = table_rows_array_1.next(); !table_rows_array_1_1.done; table_rows_array_1_1 = table_rows_array_1.next()) {
                    var rowItem = table_rows_array_1_1.value;
                    var /** @type {?} */ item = {
                        items: [],
                        headers: rowItem
                    };
                    try {
                        for (var rowItem_1 = tslib_1.__values(rowItem), rowItem_1_1 = rowItem_1.next(); !rowItem_1_1.done; rowItem_1_1 = rowItem_1.next()) {
                            var val = rowItem_1_1.value;
                            if (counter === 0 || counter % val.dimensions.col_span === 0) {
                                item.items.push({
                                    type: val.type,
                                    name: val.uid,
                                    val: val.name,
                                    row_span: val.dimensions.col_span,
                                    header: true
                                });
                            }
                        }
                    }
                    catch (e_15_1) { e_15 = { error: e_15_1 }; }
                    finally {
                        try {
                            if (rowItem_1_1 && !rowItem_1_1.done && (_12 = rowItem_1.return)) _12.call(rowItem_1);
                        }
                        finally { if (e_15) throw e_15.error; }
                    }
                    try {
                        for (var table_columns_array_1 = tslib_1.__values(table_columns_array), table_columns_array_1_1 = table_columns_array_1.next(); !table_columns_array_1_1.done; table_columns_array_1_1 = table_columns_array_1.next()) {
                            var colItem = table_columns_array_1_1.value;
                            var /** @type {?} */ dataItem = [];
                            try {
                                for (var rowItem_2 = tslib_1.__values(rowItem), rowItem_2_1 = rowItem_2.next(); !rowItem_2_1.done; rowItem_2_1 = rowItem_2.next()) {
                                    var val = rowItem_2_1.value;
                                    dataItem.push({ type: val.type, value: val.uid });
                                }
                            }
                            catch (e_16_1) { e_16 = { error: e_16_1 }; }
                            finally {
                                try {
                                    if (rowItem_2_1 && !rowItem_2_1.done && (_13 = rowItem_2.return)) _13.call(rowItem_2);
                                }
                                finally { if (e_16) throw e_16.error; }
                            }
                            try {
                                for (var colItem_1 = tslib_1.__values(colItem), colItem_1_1 = colItem_1.next(); !colItem_1_1.done; colItem_1_1 = colItem_1.next()) {
                                    var val = colItem_1_1.value;
                                    dataItem.push({ type: val.type, value: val.uid });
                                }
                            }
                            catch (e_17_1) { e_17 = { error: e_17_1 }; }
                            finally {
                                try {
                                    if (colItem_1_1 && !colItem_1_1.done && (_14 = colItem_1.return)) _14.call(colItem_1);
                                }
                                finally { if (e_17) throw e_17.error; }
                            }
                            item.items.push({
                                name: '',
                                val: getDataValue(analyticsObject, dataItem),
                                color: getDataValueColor(legendClasses, getDataValue(analyticsObject, dataItem)),
                                row_span: '1',
                                display: true
                            });
                        }
                    }
                    catch (e_18_1) { e_18 = { error: e_18_1 }; }
                    finally {
                        try {
                            if (table_columns_array_1_1 && !table_columns_array_1_1.done && (_15 = table_columns_array_1.return)) _15.call(table_columns_array_1);
                        }
                        finally { if (e_18) throw e_18.error; }
                    }
                    if (tableConfiguration.hasOwnProperty('hideEmptyRows') &&
                        tableConfiguration.hideEmptyRows) {
                        if (!checkZeros(tableConfiguration.rows.length, item.items)) {
                            table.rows.push(item);
                        }
                    }
                    else {
                        table.rows.push(item);
                    }
                    counter++;
                }
            }
            catch (e_19_1) { e_19 = { error: e_19_1 }; }
            finally {
                try {
                    if (table_rows_array_1_1 && !table_rows_array_1_1.done && (_16 = table_rows_array_1.return)) _16.call(table_rows_array_1);
                }
                finally { if (e_19) throw e_19.error; }
            }
        }
        else {
            var /** @type {?} */ item = {
                items: [],
                headers: []
            };
            try {
                for (var table_columns_array_2 = tslib_1.__values(table_columns_array), table_columns_array_2_1 = table_columns_array_2.next(); !table_columns_array_2_1.done; table_columns_array_2_1 = table_columns_array_2.next()) {
                    var colItem = table_columns_array_2_1.value;
                    var /** @type {?} */ dataItem = [];
                    try {
                        for (var colItem_2 = tslib_1.__values(colItem), colItem_2_1 = colItem_2.next(); !colItem_2_1.done; colItem_2_1 = colItem_2.next()) {
                            var val = colItem_2_1.value;
                            dataItem.push({ type: val.type, value: val.uid });
                        }
                    }
                    catch (e_20_1) { e_20 = { error: e_20_1 }; }
                    finally {
                        try {
                            if (colItem_2_1 && !colItem_2_1.done && (_17 = colItem_2.return)) _17.call(colItem_2);
                        }
                        finally { if (e_20) throw e_20.error; }
                    }
                    item.items.push({
                        name: '',
                        val: getDataValue(analyticsObject, dataItem),
                        row_span: '1',
                        display: true
                    });
                }
            }
            catch (e_21_1) { e_21 = { error: e_21_1 }; }
            finally {
                try {
                    if (table_columns_array_2_1 && !table_columns_array_2_1.done && (_18 = table_columns_array_2.return)) _18.call(table_columns_array_2);
                }
                finally { if (e_21) throw e_21.error; }
            }
            if (tableConfiguration.hasOwnProperty('hideEmptyRows') &&
                tableConfiguration.hideEmptyRows) {
                if (!checkZeros(tableConfiguration.rows.length, item.items)) {
                    table.rows.push(item);
                }
            }
            else {
                table.rows.push(item);
            }
        }
    }
    // todo improve total options to also work for event table
    // return _getSanitizedTableObject(table, tableConfiguration);
    return table;
    var e_1, _c, e_3, _j, e_2, _h, e_4, _m, e_5, _q, e_7, _u, e_6, _t, e_8, _x, e_9, _0, e_11, _4, e_10, _3, e_12, _7, e_14, _11, e_13, _10, e_19, _16, e_15, _12, e_18, _15, e_16, _13, e_17, _14, e_21, _18, e_20, _17;
}
/**
 * @param {?} analyticsObjectHeaders
 * @param {?} name
 * @return {?}
 */
function getTitleIndex(analyticsObjectHeaders, name) {
    var /** @type {?} */ index = 0;
    var /** @type {?} */ counter = 0;
    try {
        for (var analyticsObjectHeaders_1 = tslib_1.__values(analyticsObjectHeaders), analyticsObjectHeaders_1_1 = analyticsObjectHeaders_1.next(); !analyticsObjectHeaders_1_1.done; analyticsObjectHeaders_1_1 = analyticsObjectHeaders_1.next()) {
            var header = analyticsObjectHeaders_1_1.value;
            if (header.name === name) {
                index = counter;
            }
            counter++;
        }
    }
    catch (e_22_1) { e_22 = { error: e_22_1 }; }
    finally {
        try {
            if (analyticsObjectHeaders_1_1 && !analyticsObjectHeaders_1_1.done && (_a = analyticsObjectHeaders_1.return)) _a.call(analyticsObjectHeaders_1);
        }
        finally { if (e_22) throw e_22.error; }
    }
    return index;
    var e_22, _a;
}
/**
 * @param {?} analyticsObject
 * @param {?} array
 * @param {?} item
 * @return {?}
 */
function calculateColSpan(analyticsObject, array, item) {
    var /** @type {?} */ indexOfItem = array.indexOf(item);
    var /** @type {?} */ array_length = array.length;
    var /** @type {?} */ last_index = array_length - 1;
    var /** @type {?} */ dimensions = { col_span: 1, duplication: 1 };
    for (var /** @type {?} */ i = last_index; i > indexOfItem; i--) {
        var /** @type {?} */ arr = prepareSingleCategories(analyticsObject, array[i]);
        dimensions.col_span = dimensions.col_span * arr.length;
    }
    for (var /** @type {?} */ i = 0; i < indexOfItem; i++) {
        var /** @type {?} */ arr = prepareSingleCategories(analyticsObject, array[i]);
        dimensions.duplication = dimensions.duplication * arr.length;
    }
    return dimensions;
}
/**
 * @param {?} initialAnalytics
 * @param {?} itemIdentifier
 * @param {?=} preDefinedItems
 * @return {?}
 */
function prepareSingleCategories(initialAnalytics, itemIdentifier, preDefinedItems) {
    if (preDefinedItems === void 0) { preDefinedItems = []; }
    var /** @type {?} */ analyticsObject = sanitizeIncomingAnalytics(initialAnalytics);
    var /** @type {?} */ structure = [];
    if (preDefinedItems.length === 0) {
        try {
            for (var _a = tslib_1.__values(getMetadataArray(analyticsObject, itemIdentifier)), _b = _a.next(); !_b.done; _b = _a.next()) {
                var val = _b.value;
                structure.push({
                    name: analyticsObject.metaData.names[val],
                    uid: val,
                    type: itemIdentifier
                });
            }
        }
        catch (e_23_1) { e_23 = { error: e_23_1 }; }
        finally {
            try {
                if (_b && !_b.done && (_c = _a.return)) _c.call(_a);
            }
            finally { if (e_23) throw e_23.error; }
        }
    }
    if (preDefinedItems.length !== 0) {
        try {
            for (var preDefinedItems_1 = tslib_1.__values(preDefinedItems), preDefinedItems_1_1 = preDefinedItems_1.next(); !preDefinedItems_1_1.done; preDefinedItems_1_1 = preDefinedItems_1.next()) {
                var val = preDefinedItems_1_1.value;
                structure.push({
                    name: analyticsObject.metaData.names[val],
                    uid: val,
                    type: itemIdentifier
                });
            }
        }
        catch (e_24_1) { e_24 = { error: e_24_1 }; }
        finally {
            try {
                if (preDefinedItems_1_1 && !preDefinedItems_1_1.done && (_d = preDefinedItems_1.return)) _d.call(preDefinedItems_1);
            }
            finally { if (e_24) throw e_24.error; }
        }
    }
    return structure;
    var e_23, _c, e_24, _d;
}
/**
 * @param {?} analyticsObject
 * @return {?}
 */
function sanitizeIncomingAnalytics(analyticsObject) {
    return analyticsObject;
}
/**
 * @param {?} analyticsObject
 * @param {?} metadataType
 * @return {?}
 */
function getMetadataArray(analyticsObject, metadataType) {
    var /** @type {?} */ metadataArray = [];
    if (metadataType === 'dx') {
        metadataArray = analyticsObject.metaData.dx;
    }
    else if (metadataType === 'ou') {
        metadataArray = analyticsObject.metaData.ou;
    }
    else if (metadataType === 'co') {
        metadataArray = analyticsObject.metaData.co;
    }
    else if (metadataType === 'pe') {
        metadataArray = analyticsObject.metaData.pe;
    }
    else {
        metadataArray = analyticsObject.metaData[metadataType];
    }
    return metadataArray;
}
/**
 * @param {?} analyticsObject
 * @param {?=} dataItems
 * @return {?}
 */
function getDataValue(analyticsObject, dataItems) {
    if (dataItems === void 0) { dataItems = []; }
    var /** @type {?} */ num = null;
    try {
        for (var _a = tslib_1.__values(analyticsObject.rows), _b = _a.next(); !_b.done; _b = _a.next()) {
            var value = _b.value;
            var /** @type {?} */ counter = 0;
            try {
                for (var dataItems_1 = tslib_1.__values(dataItems), dataItems_1_1 = dataItems_1.next(); !dataItems_1_1.done; dataItems_1_1 = dataItems_1.next()) {
                    var item = dataItems_1_1.value;
                    if (value[getTitleIndex(analyticsObject.headers, item.type)] === item.value) {
                        counter++;
                    }
                }
            }
            catch (e_25_1) { e_25 = { error: e_25_1 }; }
            finally {
                try {
                    if (dataItems_1_1 && !dataItems_1_1.done && (_c = dataItems_1.return)) _c.call(dataItems_1);
                }
                finally { if (e_25) throw e_25.error; }
            }
            if (counter === dataItems.length) {
                if (isNaN(value[getTitleIndex(analyticsObject.headers, 'value')])) {
                    num = value[getTitleIndex(analyticsObject.headers, 'value')];
                }
                else {
                    num += parseFloat(value[getTitleIndex(analyticsObject.headers, 'value')]);
                }
            }
        }
    }
    catch (e_26_1) { e_26 = { error: e_26_1 }; }
    finally {
        try {
            if (_b && !_b.done && (_d = _a.return)) _d.call(_a);
        }
        finally { if (e_26) throw e_26.error; }
    }
    return num;
    var e_26, _d, e_25, _c;
}
/**
 * @param {?} legendClasses
 * @param {?} value
 * @return {?}
 */
function getDataValueColor(legendClasses, value) {
    var /** @type {?} */ color = '';
    if (!isNaN(value) && legendClasses) {
        legendClasses.forEach(function (legendClass) {
            if (legendClass.startValue <= value && legendClass.endValue > value) {
                color = legendClass.color;
            }
            // if (legendClass.startValue < value && legendClass.endValue >= value) {
            // }
        });
    }
    return color;
}
/**
 * @param {?} stating_length
 * @param {?} array
 * @return {?}
 */
function checkZeros(stating_length, array) {
    var /** @type {?} */ checker = true;
    for (var /** @type {?} */ i = stating_length; i < array.length; i++) {
        if (array[i].name === '' && array[i].val != null) {
            checker = false;
        }
    }
    return checker;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHJhdy10YWJsZS5oZWxwZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AaGlzcHR6L25neC1kaGlzMi10YWJsZS8iLCJzb3VyY2VzIjpbImxpYi9oZWxwZXJzL2RyYXctdGFibGUuaGVscGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFDQSxNQUFNLG9CQUNKLGVBQWUsRUFDZixrQkFBc0M7SUFFdEMscUJBQU0sYUFBYSxHQUFHLGtCQUFrQixDQUFDLFNBQVM7UUFDaEQsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxPQUFPO1FBQ3RDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFFVCxxQkFBTSxLQUFLLEdBQUc7UUFDWixPQUFPLEVBQUUsRUFBRTtRQUNYLE9BQU8sRUFBRSxFQUFFO1FBQ1gsSUFBSSxFQUFFLEVBQUU7UUFDUixNQUFNLEVBQUU7WUFDTixJQUFJLEVBQUUsRUFBRTtZQUNSLE1BQU0sRUFBRSxFQUFFO1NBQ1g7UUFDRCxlQUFlLEVBQUUsS0FBSztRQUN0QixXQUFXLEVBQUUsS0FBSztLQUNuQixDQUFDO0lBQ0YsRUFBRSxDQUFDLENBQUMsa0JBQWtCLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMvQyxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsa0JBQWtCLENBQUMsS0FBSyxDQUFDO0tBQzNDO0lBQ0QsRUFBRSxDQUFDLENBQUMsa0JBQWtCLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsa0JBQWtCLENBQUMsUUFBUSxDQUFDO0tBQ2pEO0lBQ0QsRUFBRSxDQUFDLENBQUMsa0JBQWtCLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUNuQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxHQUFHO1lBQ2pCLEtBQUssRUFBRSxFQUFFO1lBQ1QsS0FBSyxFQUFFLEVBQUU7U0FDVixDQUFDO1FBQ0Ysa0JBQWtCLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEUsV0FBVyxDQUFDO1FBQ2Qsa0JBQWtCLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEUsUUFBUSxDQUFDOztZQUNYLEdBQUcsQ0FBQyxDQUFlLElBQUEsS0FBQSxpQkFBQSxrQkFBa0IsQ0FBQyxPQUFPLENBQUEsZ0JBQUE7Z0JBQXhDLElBQU0sSUFBSSxXQUFBO2dCQUNiLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQztvQkFDMUIsSUFBSSxFQUNGLGVBQWUsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7eUJBQ2xFLE1BQU07b0JBQ1gsSUFBSSxFQUFFLENBQUM7aUJBQ1IsQ0FBQyxDQUFDO2FBQ0o7Ozs7Ozs7Ozs7WUFDRCxHQUFHLENBQUMsQ0FBZSxJQUFBLEtBQUEsaUJBQUEsZUFBZSxDQUFDLElBQUksQ0FBQSxnQkFBQTtnQkFBbEMsSUFBTSxJQUFJLFdBQUE7Z0JBQ2IscUJBQU0sWUFBWSxHQUFHLEVBQUUsQ0FBQzs7b0JBQ3hCLEdBQUcsQ0FBQyxDQUFjLElBQUEsS0FBQSxpQkFBQSxrQkFBa0IsQ0FBQyxPQUFPLENBQUEsZ0JBQUE7d0JBQXZDLElBQU0sR0FBRyxXQUFBO3dCQUNaLHFCQUFNLEtBQUssR0FBRyxhQUFhLENBQUMsZUFBZSxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsQ0FBQzt3QkFDMUQsWUFBWSxDQUFDLElBQUksQ0FBQzs0QkFDaEIsSUFBSSxFQUFFLEVBQUU7NEJBQ1IsT0FBTyxFQUFFLElBQUk7NEJBQ2IsUUFBUSxFQUFFLEdBQUc7OzRCQUViLEdBQUcsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDO3lCQUNqQixDQUFDLENBQUM7cUJBQ0o7Ozs7Ozs7OztnQkFDRCxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztvQkFDZCxPQUFPLEVBQUUsRUFBRTtvQkFDWCxLQUFLLEVBQUUsWUFBWTtpQkFDcEIsQ0FBQyxDQUFDO2FBQ0o7Ozs7Ozs7OztLQUNGO0lBQUMsSUFBSSxDQUFDLENBQUM7O1FBRU4sRUFBRSxDQUFDLENBQUMsa0JBQWtCLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDO1lBQzNDLEtBQUssQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDOztnQkFDN0IsR0FBRyxDQUFDLENBQWUsSUFBQSxLQUFBLGlCQUFBLGtCQUFrQixDQUFDLE9BQU8sQ0FBQSxnQkFBQTtvQkFBeEMsSUFBTSxJQUFJLFdBQUE7b0JBQ2IsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUN0QixlQUFlLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO3lCQUNsRSxNQUFNLENBQ1YsQ0FBQztpQkFDSDs7Ozs7Ozs7OztnQkFDRCxHQUFHLENBQUMsQ0FBZSxJQUFBLEtBQUEsaUJBQUEsa0JBQWtCLENBQUMsSUFBSSxDQUFBLGdCQUFBO29CQUFyQyxJQUFNLElBQUksV0FBQTtvQkFDYixLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQ3BCLGVBQWUsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7eUJBQ2xFLE1BQU0sQ0FDVixDQUFDO2lCQUNIOzs7Ozs7Ozs7U0FDRjs7WUFDRCxHQUFHLENBQUMsQ0FBcUIsSUFBQSxLQUFBLGlCQUFBLGtCQUFrQixDQUFDLE9BQU8sQ0FBQSxnQkFBQTtnQkFBOUMsSUFBTSxVQUFVLFdBQUE7Z0JBQ25CLHFCQUFNLFNBQVMsR0FBRyxnQkFBZ0IsQ0FDaEMsZUFBZSxFQUNmLGtCQUFrQixDQUFDLE9BQU8sRUFDMUIsVUFBVSxDQUNYLENBQUM7Z0JBQ0YscUJBQU0sa0JBQWtCLEdBQUcsdUJBQXVCLENBQ2hELGVBQWUsRUFDZixVQUFVLENBQ1gsQ0FBQztnQkFDRixxQkFBTSxVQUFVLEdBQUcsRUFBRSxDQUFDO2dCQUN0QixHQUFHLENBQUMsQ0FBQyxxQkFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7O3dCQUMvQyxHQUFHLENBQUMsQ0FBc0IsSUFBQSx1QkFBQSxpQkFBQSxrQkFBa0IsQ0FBQSxzREFBQTs0QkFBdkMsSUFBTSxXQUFXLCtCQUFBOzRCQUNwQixVQUFVLENBQUMsSUFBSSxDQUFDO2dDQUNkLElBQUksRUFBRSxXQUFXLENBQUMsSUFBSTtnQ0FDdEIsSUFBSSxFQUFFLFNBQVMsQ0FBQyxRQUFRO2dDQUN4QixJQUFJLEVBQUUsV0FBVyxDQUFDLElBQUk7Z0NBQ3RCLEVBQUUsRUFBRSxXQUFXLENBQUMsR0FBRzs2QkFDcEIsQ0FBQyxDQUFDO3lCQUNKOzs7Ozs7Ozs7aUJBQ0Y7Z0JBQ0QscUJBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQztnQkFDaEIsRUFBRSxDQUFDLENBQUMsa0JBQWtCLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDL0MsRUFBRSxDQUFDLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7d0JBQ3pELE1BQU0sR0FBRyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUM7cUJBQ2hEO2lCQUNGO2dCQUNELEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQzthQUMxRDs7Ozs7Ozs7OztZQUNELEdBQUcsQ0FBQyxDQUFrQixJQUFBLEtBQUEsaUJBQUEsa0JBQWtCLENBQUMsSUFBSSxDQUFBLGdCQUFBO2dCQUF4QyxJQUFNLE9BQU8sV0FBQTtnQkFDaEIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7YUFDN0I7Ozs7Ozs7Ozs7UUFHRCxxQkFBTSxhQUFhLEdBQUcsa0JBQWtCLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztRQUN4RCxxQkFBTSxrQkFBa0IsR0FBRyxFQUFFLENBQUM7UUFDOUIsR0FBRyxDQUFDLENBQUMscUJBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsYUFBYSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDdkMscUJBQU0sZUFBZSxHQUFHLHVCQUF1QixDQUM3QyxlQUFlLEVBQ2Ysa0JBQWtCLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUM5QixDQUFDO1lBQ0Ysa0JBQWtCLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1NBQzFDO1FBQ0QscUJBQUksbUJBQW1CLEdBQUcsRUFBRSxDQUFDO1FBQzdCLEdBQUcsQ0FBQyxDQUFDLHFCQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQ25ELEVBQUUsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDOztvQkFDckMsR0FBRyxDQUFDLENBQWUsSUFBQSxLQUFBLGlCQUFBLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFBLGdCQUFBO3dCQUFuQyxJQUFNLElBQUksV0FBQTt3QkFDYixtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO3FCQUNsQzs7Ozs7Ozs7O2FBQ0Y7WUFBQyxJQUFJLENBQUMsQ0FBQztnQkFDTixxQkFBTSxRQUFRLEdBQUcsbUJBQW1CLENBQUMsTUFBTSxFQUFFLENBQUM7Z0JBQzlDLG1CQUFtQixHQUFHLEVBQUUsQ0FBQzs7b0JBQ3pCLEdBQUcsQ0FBQyxDQUFlLElBQUEsYUFBQSxpQkFBQSxRQUFRLENBQUEsa0NBQUE7d0JBQXRCLElBQU0sSUFBSSxxQkFBQTs7NEJBQ2IsR0FBRyxDQUFDLENBQWMsSUFBQSxLQUFBLGlCQUFBLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFBLGdCQUFBO2dDQUFsQyxJQUFNLEdBQUcsV0FBQTtnQ0FDWixFQUFFLENBQUMsQ0FBQyxJQUFJLFlBQVksS0FBSyxDQUFDLENBQUMsQ0FBQztvQ0FDMUIscUJBQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7b0NBQ2pDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2lDQUNqRDtnQ0FBQyxJQUFJLENBQUMsQ0FBQztvQ0FDTixtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztpQ0FDdkM7NkJBQ0Y7Ozs7Ozs7OztxQkFDRjs7Ozs7Ozs7O2FBQ0Y7U0FDRjs7UUFHRCxxQkFBTSxXQUFXLEdBQUcsa0JBQWtCLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUNuRCxxQkFBTSxlQUFlLEdBQUcsRUFBRSxDQUFDO1FBQzNCLEdBQUcsQ0FBQyxDQUFDLHFCQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFdBQVcsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQ3JDLHFCQUFNLFNBQVMsR0FBRyxnQkFBZ0IsQ0FDaEMsZUFBZSxFQUNmLGtCQUFrQixDQUFDLElBQUksRUFDdkIsa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUMzQixDQUFDO1lBQ0YscUJBQU0sZUFBZSxHQUFHLHVCQUF1QixDQUM3QyxlQUFlLEVBQ2Ysa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUMzQixDQUFDO1lBQ0YsZUFBZSxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxlQUFlLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUM7U0FDekU7UUFDRCxxQkFBSSxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFDMUIsR0FBRyxDQUFDLENBQUMscUJBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsZUFBZSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQ2hELEVBQUUsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDOztvQkFDbEMsR0FBRyxDQUFDLENBQWUsSUFBQSxLQUFBLGlCQUFBLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUEsZ0JBQUE7d0JBQXRDLElBQU0sSUFBSSxXQUFBO3dCQUNiLElBQUksQ0FBQyxVQUFVLEdBQUcsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQzt3QkFDaEQsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztxQkFDL0I7Ozs7Ozs7OzthQUNGO1lBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ04scUJBQU0sUUFBUSxHQUFHLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxDQUFDO2dCQUMzQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7O29CQUN0QixHQUFHLENBQUMsQ0FBZSxJQUFBLGFBQUEsaUJBQUEsUUFBUSxDQUFBLGtDQUFBO3dCQUF0QixJQUFNLElBQUkscUJBQUE7OzRCQUNiLEdBQUcsQ0FBQyxDQUFjLElBQUEsS0FBQSxpQkFBQSxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFBLGdCQUFBO2dDQUFyQyxJQUFNLEdBQUcsV0FBQTtnQ0FDWixHQUFHLENBQUMsVUFBVSxHQUFHLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUM7Z0NBQy9DLEVBQUUsQ0FBQyxDQUFDLElBQUksWUFBWSxLQUFLLENBQUMsQ0FBQyxDQUFDO29DQUMxQixxQkFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztvQ0FDakMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7aUNBQzlDO2dDQUFDLElBQUksQ0FBQyxDQUFDO29DQUNOLGdCQUFnQixDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO2lDQUNwQzs2QkFDRjs7Ozs7Ozs7O3FCQUNGOzs7Ozs7Ozs7YUFDRjtTQUNGO1FBRUQscUJBQUksT0FBTyxHQUFHLENBQUMsQ0FBQztRQUNoQixFQUFFLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzs7Z0JBQ2xDLEdBQUcsQ0FBQyxDQUFrQixJQUFBLHFCQUFBLGlCQUFBLGdCQUFnQixDQUFBLGtEQUFBO29CQUFqQyxJQUFNLE9BQU8sNkJBQUE7b0JBQ2hCLHFCQUFNLElBQUksR0FBRzt3QkFDWCxLQUFLLEVBQUUsRUFBRTt3QkFDVCxPQUFPLEVBQUUsT0FBTztxQkFDakIsQ0FBQzs7d0JBQ0YsR0FBRyxDQUFDLENBQWMsSUFBQSxZQUFBLGlCQUFBLE9BQU8sQ0FBQSxnQ0FBQTs0QkFBcEIsSUFBTSxHQUFHLG9CQUFBOzRCQUNaLEVBQUUsQ0FBQyxDQUFDLE9BQU8sS0FBSyxDQUFDLElBQUksT0FBTyxHQUFHLEdBQUcsQ0FBQyxVQUFVLENBQUMsUUFBUSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0NBQzdELElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO29DQUNkLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSTtvQ0FDZCxJQUFJLEVBQUUsR0FBRyxDQUFDLEdBQUc7b0NBQ2IsR0FBRyxFQUFFLEdBQUcsQ0FBQyxJQUFJO29DQUNiLFFBQVEsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLFFBQVE7b0NBQ2pDLE1BQU0sRUFBRSxJQUFJO2lDQUNiLENBQUMsQ0FBQzs2QkFDSjt5QkFDRjs7Ozs7Ozs7Ozt3QkFDRCxHQUFHLENBQUMsQ0FBa0IsSUFBQSx3QkFBQSxpQkFBQSxtQkFBbUIsQ0FBQSx3REFBQTs0QkFBcEMsSUFBTSxPQUFPLGdDQUFBOzRCQUNoQixxQkFBTSxRQUFRLEdBQUcsRUFBRSxDQUFDOztnQ0FDcEIsR0FBRyxDQUFDLENBQWMsSUFBQSxZQUFBLGlCQUFBLE9BQU8sQ0FBQSxnQ0FBQTtvQ0FBcEIsSUFBTSxHQUFHLG9CQUFBO29DQUNaLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7aUNBQ25EOzs7Ozs7Ozs7O2dDQUNELEdBQUcsQ0FBQyxDQUFjLElBQUEsWUFBQSxpQkFBQSxPQUFPLENBQUEsZ0NBQUE7b0NBQXBCLElBQU0sR0FBRyxvQkFBQTtvQ0FDWixRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO2lDQUNuRDs7Ozs7Ozs7OzRCQUNELElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO2dDQUNkLElBQUksRUFBRSxFQUFFO2dDQUNSLEdBQUcsRUFBRSxZQUFZLENBQUMsZUFBZSxFQUFFLFFBQVEsQ0FBQztnQ0FDNUMsS0FBSyxFQUFFLGlCQUFpQixDQUN0QixhQUFhLEVBQ2IsWUFBWSxDQUFDLGVBQWUsRUFBRSxRQUFRLENBQUMsQ0FDeEM7Z0NBQ0QsUUFBUSxFQUFFLEdBQUc7Z0NBQ2IsT0FBTyxFQUFFLElBQUk7NkJBQ2QsQ0FBQyxDQUFDO3lCQUNKOzs7Ozs7Ozs7b0JBQ0QsRUFBRSxDQUFDLENBQ0Qsa0JBQWtCLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQzt3QkFDbEQsa0JBQWtCLENBQUMsYUFDckIsQ0FBQyxDQUFDLENBQUM7d0JBQ0QsRUFBRSxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDOzRCQUM1RCxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzt5QkFDdkI7cUJBQ0Y7b0JBQUMsSUFBSSxDQUFDLENBQUM7d0JBQ04sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7cUJBQ3ZCO29CQUVELE9BQU8sRUFBRSxDQUFDO2lCQUNYOzs7Ozs7Ozs7U0FDRjtRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ04scUJBQU0sSUFBSSxHQUFHO2dCQUNYLEtBQUssRUFBRSxFQUFFO2dCQUNULE9BQU8sRUFBRSxFQUFFO2FBQ1osQ0FBQzs7Z0JBQ0YsR0FBRyxDQUFDLENBQWtCLElBQUEsd0JBQUEsaUJBQUEsbUJBQW1CLENBQUEsd0RBQUE7b0JBQXBDLElBQU0sT0FBTyxnQ0FBQTtvQkFDaEIscUJBQU0sUUFBUSxHQUFHLEVBQUUsQ0FBQzs7d0JBQ3BCLEdBQUcsQ0FBQyxDQUFjLElBQUEsWUFBQSxpQkFBQSxPQUFPLENBQUEsZ0NBQUE7NEJBQXBCLElBQU0sR0FBRyxvQkFBQTs0QkFDWixRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO3lCQUNuRDs7Ozs7Ozs7O29CQUNELElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO3dCQUNkLElBQUksRUFBRSxFQUFFO3dCQUNSLEdBQUcsRUFBRSxZQUFZLENBQUMsZUFBZSxFQUFFLFFBQVEsQ0FBQzt3QkFDNUMsUUFBUSxFQUFFLEdBQUc7d0JBQ2IsT0FBTyxFQUFFLElBQUk7cUJBQ2QsQ0FBQyxDQUFDO2lCQUNKOzs7Ozs7Ozs7WUFDRCxFQUFFLENBQUMsQ0FDRCxrQkFBa0IsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDO2dCQUNsRCxrQkFBa0IsQ0FBQyxhQUNyQixDQUFDLENBQUMsQ0FBQztnQkFDRCxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQzVELEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2lCQUN2QjthQUNGO1lBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ04sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDdkI7U0FDRjtLQUNGOzs7SUFJRCxNQUFNLENBQUMsS0FBSyxDQUFDOztDQUNkOzs7Ozs7QUFFRCx1QkFBdUIsc0JBQXNCLEVBQUUsSUFBWTtJQUN6RCxxQkFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDO0lBQ2QscUJBQUksT0FBTyxHQUFHLENBQUMsQ0FBQzs7UUFDaEIsR0FBRyxDQUFDLENBQWlCLElBQUEsMkJBQUEsaUJBQUEsc0JBQXNCLENBQUEsOERBQUE7WUFBdEMsSUFBTSxNQUFNLG1DQUFBO1lBQ2YsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDO2dCQUN6QixLQUFLLEdBQUcsT0FBTyxDQUFDO2FBQ2pCO1lBQ0QsT0FBTyxFQUFFLENBQUM7U0FDWDs7Ozs7Ozs7O0lBQ0QsTUFBTSxDQUFDLEtBQUssQ0FBQzs7Q0FDZDs7Ozs7OztBQUVELDBCQUEwQixlQUFlLEVBQUUsS0FBSyxFQUFFLElBQUk7SUFDcEQscUJBQU0sV0FBVyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDeEMscUJBQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUM7SUFDbEMscUJBQU0sVUFBVSxHQUFHLFlBQVksR0FBRyxDQUFDLENBQUM7SUFDcEMscUJBQU0sVUFBVSxHQUFHLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLENBQUM7SUFDbkQsR0FBRyxDQUFDLENBQUMscUJBQUksQ0FBQyxHQUFHLFVBQVUsRUFBRSxDQUFDLEdBQUcsV0FBVyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDOUMscUJBQU0sR0FBRyxHQUFHLHVCQUF1QixDQUFDLGVBQWUsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMvRCxVQUFVLENBQUMsUUFBUSxHQUFHLFVBQVUsQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQztLQUN4RDtJQUNELEdBQUcsQ0FBQyxDQUFDLHFCQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFdBQVcsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ3JDLHFCQUFNLEdBQUcsR0FBRyx1QkFBdUIsQ0FBQyxlQUFlLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDL0QsVUFBVSxDQUFDLFdBQVcsR0FBRyxVQUFVLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUM7S0FDOUQ7SUFDRCxNQUFNLENBQUMsVUFBVSxDQUFDO0NBQ25COzs7Ozs7O0FBRUQsaUNBQ0UsZ0JBQWdCLEVBQ2hCLGNBQWMsRUFDZCxlQUFvQjtJQUFwQixnQ0FBQSxFQUFBLG9CQUFvQjtJQUVwQixxQkFBTSxlQUFlLEdBQUcseUJBQXlCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUNwRSxxQkFBTSxTQUFTLEdBQUcsRUFBRSxDQUFDO0lBQ3JCLEVBQUUsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzs7WUFDakMsR0FBRyxDQUFDLENBQWMsSUFBQSxLQUFBLGlCQUFBLGdCQUFnQixDQUFDLGVBQWUsRUFBRSxjQUFjLENBQUMsQ0FBQSxnQkFBQTtnQkFBOUQsSUFBTSxHQUFHLFdBQUE7Z0JBQ1osU0FBUyxDQUFDLElBQUksQ0FBQztvQkFDYixJQUFJLEVBQUUsZUFBZSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO29CQUN6QyxHQUFHLEVBQUUsR0FBRztvQkFDUixJQUFJLEVBQUUsY0FBYztpQkFDckIsQ0FBQyxDQUFDO2FBQ0o7Ozs7Ozs7OztLQUNGO0lBQ0QsRUFBRSxDQUFDLENBQUMsZUFBZSxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDOztZQUNqQyxHQUFHLENBQUMsQ0FBYyxJQUFBLG9CQUFBLGlCQUFBLGVBQWUsQ0FBQSxnREFBQTtnQkFBNUIsSUFBTSxHQUFHLDRCQUFBO2dCQUNaLFNBQVMsQ0FBQyxJQUFJLENBQUM7b0JBQ2IsSUFBSSxFQUFFLGVBQWUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztvQkFDekMsR0FBRyxFQUFFLEdBQUc7b0JBQ1IsSUFBSSxFQUFFLGNBQWM7aUJBQ3JCLENBQUMsQ0FBQzthQUNKOzs7Ozs7Ozs7S0FDRjtJQUNELE1BQU0sQ0FBQyxTQUFTLENBQUM7O0NBQ2xCOzs7OztBQUVELG1DQUFtQyxlQUFvQjtJQUNyRCxNQUFNLENBQUMsZUFBZSxDQUFDO0NBQ3hCOzs7Ozs7QUFFRCwwQkFBMEIsZUFBZSxFQUFFLFlBQW9CO0lBQzdELHFCQUFJLGFBQWEsR0FBRyxFQUFFLENBQUM7SUFDdkIsRUFBRSxDQUFDLENBQUMsWUFBWSxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDMUIsYUFBYSxHQUFHLGVBQWUsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO0tBQzdDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFlBQVksS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ2pDLGFBQWEsR0FBRyxlQUFlLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztLQUM3QztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxZQUFZLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQztRQUNqQyxhQUFhLEdBQUcsZUFBZSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7S0FDN0M7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsWUFBWSxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDakMsYUFBYSxHQUFHLGVBQWUsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO0tBQzdDO0lBQUMsSUFBSSxDQUFDLENBQUM7UUFDTixhQUFhLEdBQUcsZUFBZSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQztLQUN4RDtJQUNELE1BQU0sQ0FBQyxhQUFhLENBQUM7Q0FDdEI7Ozs7OztBQUVELHNCQUFzQixlQUFlLEVBQUUsU0FBYztJQUFkLDBCQUFBLEVBQUEsY0FBYztJQUNuRCxxQkFBSSxHQUFHLEdBQUcsSUFBSSxDQUFDOztRQUNmLEdBQUcsQ0FBQyxDQUFnQixJQUFBLEtBQUEsaUJBQUEsZUFBZSxDQUFDLElBQUksQ0FBQSxnQkFBQTtZQUFuQyxJQUFNLEtBQUssV0FBQTtZQUNkLHFCQUFJLE9BQU8sR0FBRyxDQUFDLENBQUM7O2dCQUNoQixHQUFHLENBQUMsQ0FBZSxJQUFBLGNBQUEsaUJBQUEsU0FBUyxDQUFBLG9DQUFBO29CQUF2QixJQUFNLElBQUksc0JBQUE7b0JBQ2IsRUFBRSxDQUFDLENBQ0QsS0FBSyxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxLQUNwRSxDQUFDLENBQUMsQ0FBQzt3QkFDRCxPQUFPLEVBQUUsQ0FBQztxQkFDWDtpQkFDRjs7Ozs7Ozs7O1lBQ0QsRUFBRSxDQUFDLENBQUMsT0FBTyxLQUFLLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO2dCQUNqQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ2xFLEdBQUcsR0FBRyxLQUFLLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztpQkFDOUQ7Z0JBQUMsSUFBSSxDQUFDLENBQUM7b0JBQ04sR0FBRyxJQUFJLFVBQVUsQ0FDZixLQUFLLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FDdkQsQ0FBQztpQkFDSDthQUNGO1NBQ0Y7Ozs7Ozs7OztJQUNELE1BQU0sQ0FBQyxHQUFHLENBQUM7O0NBQ1o7Ozs7OztBQUVELDJCQUEyQixhQUFhLEVBQUUsS0FBSztJQUM3QyxxQkFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO0lBQ2YsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksYUFBYSxDQUFDLENBQUMsQ0FBQztRQUNuQyxhQUFhLENBQUMsT0FBTyxDQUFDLFVBQUEsV0FBVztZQUMvQixFQUFFLENBQUMsQ0FBQyxXQUFXLENBQUMsVUFBVSxJQUFJLEtBQUssSUFBSSxXQUFXLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0JBQ3BFLEtBQUssR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDO2FBQzNCOzs7U0FLRixDQUFDLENBQUM7S0FDSjtJQUNELE1BQU0sQ0FBQyxLQUFLLENBQUM7Q0FDZDs7Ozs7O0FBRUQsb0JBQW9CLGNBQWMsRUFBRSxLQUFLO0lBQ3ZDLHFCQUFJLE9BQU8sR0FBRyxJQUFJLENBQUM7SUFDbkIsR0FBRyxDQUFDLENBQUMscUJBQUksQ0FBQyxHQUFHLGNBQWMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ25ELEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssRUFBRSxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztZQUNqRCxPQUFPLEdBQUcsS0FBSyxDQUFDO1NBQ2pCO0tBQ0Y7SUFDRCxNQUFNLENBQUMsT0FBTyxDQUFDO0NBQ2hCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGFibGVDb25maWd1cmF0aW9uIH0gZnJvbSAnLi4vbW9kZWxzL3RhYmxlLWNvbmZpZ3VyYXRpb24nO1xuZXhwb3J0IGZ1bmN0aW9uIGRyYXdUYWJsZShcbiAgYW5hbHl0aWNzT2JqZWN0LFxuICB0YWJsZUNvbmZpZ3VyYXRpb246IFRhYmxlQ29uZmlndXJhdGlvblxuKSB7XG4gIGNvbnN0IGxlZ2VuZENsYXNzZXMgPSB0YWJsZUNvbmZpZ3VyYXRpb24ubGVnZW5kU2V0XG4gICAgPyB0YWJsZUNvbmZpZ3VyYXRpb24ubGVnZW5kU2V0LmxlZ2VuZHNcbiAgICA6IG51bGw7XG5cbiAgY29uc3QgdGFibGUgPSB7XG4gICAgaGVhZGVyczogW10sXG4gICAgY29sdW1uczogW10sXG4gICAgcm93czogW10sXG4gICAgdGl0bGVzOiB7XG4gICAgICByb3dzOiBbXSxcbiAgICAgIGNvbHVtbjogW11cbiAgICB9LFxuICAgIHRpdGxlc0F2YWlsYWJsZTogZmFsc2UsXG4gICAgaGFzUGFyZW50T3U6IGZhbHNlXG4gIH07XG4gIGlmICh0YWJsZUNvbmZpZ3VyYXRpb24uaGFzT3duUHJvcGVydHkoJ3RpdGxlJykpIHtcbiAgICB0YWJsZVsndGl0bGUnXSA9IHRhYmxlQ29uZmlndXJhdGlvbi50aXRsZTtcbiAgfVxuICBpZiAodGFibGVDb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KCdzdWJ0aXRsZScpKSB7XG4gICAgdGFibGVbJ3N1YnRpdGxlJ10gPSB0YWJsZUNvbmZpZ3VyYXRpb24uc3VidGl0bGU7XG4gIH1cbiAgaWYgKHRhYmxlQ29uZmlndXJhdGlvbi5kaXNwbGF5TGlzdCkge1xuICAgIHRhYmxlLmhlYWRlcnNbMF0gPSB7XG4gICAgICBpdGVtczogW10sXG4gICAgICBzdHlsZTogJydcbiAgICB9O1xuICAgIHRhYmxlQ29uZmlndXJhdGlvbi5jb2x1bW5zW3RhYmxlQ29uZmlndXJhdGlvbi5jb2x1bW5zLmluZGV4T2YoJ3BlJyldID1cbiAgICAgICdldmVudGRhdGUnO1xuICAgIHRhYmxlQ29uZmlndXJhdGlvbi5jb2x1bW5zW3RhYmxlQ29uZmlndXJhdGlvbi5jb2x1bW5zLmluZGV4T2YoJ291JyldID1cbiAgICAgICdvdW5hbWUnO1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiB0YWJsZUNvbmZpZ3VyYXRpb24uY29sdW1ucykge1xuICAgICAgdGFibGUuaGVhZGVyc1swXS5pdGVtcy5wdXNoKHtcbiAgICAgICAgbmFtZTpcbiAgICAgICAgICBhbmFseXRpY3NPYmplY3QuaGVhZGVyc1tnZXRUaXRsZUluZGV4KGFuYWx5dGljc09iamVjdC5oZWFkZXJzLCBpdGVtKV1cbiAgICAgICAgICAgIC5jb2x1bW4sXG4gICAgICAgIHNwYW46IDFcbiAgICAgIH0pO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgYW5hbHl0aWNzT2JqZWN0LnJvd3MpIHtcbiAgICAgIGNvbnN0IGNvbHVtbl9pdGVtcyA9IFtdO1xuICAgICAgZm9yIChjb25zdCBjb2wgb2YgdGFibGVDb25maWd1cmF0aW9uLmNvbHVtbnMpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSBnZXRUaXRsZUluZGV4KGFuYWx5dGljc09iamVjdC5oZWFkZXJzLCBjb2wpO1xuICAgICAgICBjb2x1bW5faXRlbXMucHVzaCh7XG4gICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgZGlzcGxheTogdHJ1ZSxcbiAgICAgICAgICByb3dfc3BhbjogJzEnLFxuICAgICAgICAgIC8vIGNvbG9yOmdldENvbG9yKGl0ZW1baW5kZXhdLClcbiAgICAgICAgICB2YWw6IGl0ZW1baW5kZXhdXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGFibGUucm93cy5wdXNoKHtcbiAgICAgICAgaGVhZGVyczogW10sXG4gICAgICAgIGl0ZW1zOiBjb2x1bW5faXRlbXNcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBhZGQgbmFtZXMgdG8gdGl0bGVzIGFycmF5XG4gICAgaWYgKHRhYmxlQ29uZmlndXJhdGlvbi5zaG93RGltZW5zaW9uTGFiZWxzKSB7XG4gICAgICB0YWJsZS50aXRsZXNBdmFpbGFibGUgPSB0cnVlO1xuICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRhYmxlQ29uZmlndXJhdGlvbi5jb2x1bW5zKSB7XG4gICAgICAgIHRhYmxlLnRpdGxlcy5jb2x1bW4ucHVzaChcbiAgICAgICAgICBhbmFseXRpY3NPYmplY3QuaGVhZGVyc1tnZXRUaXRsZUluZGV4KGFuYWx5dGljc09iamVjdC5oZWFkZXJzLCBpdGVtKV1cbiAgICAgICAgICAgIC5jb2x1bW5cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0YWJsZUNvbmZpZ3VyYXRpb24ucm93cykge1xuICAgICAgICB0YWJsZS50aXRsZXMucm93cy5wdXNoKFxuICAgICAgICAgIGFuYWx5dGljc09iamVjdC5oZWFkZXJzW2dldFRpdGxlSW5kZXgoYW5hbHl0aWNzT2JqZWN0LmhlYWRlcnMsIGl0ZW0pXVxuICAgICAgICAgICAgLmNvbHVtblxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGNvbHVtbkl0ZW0gb2YgdGFibGVDb25maWd1cmF0aW9uLmNvbHVtbnMpIHtcbiAgICAgIGNvbnN0IGRpbWVuc2lvbiA9IGNhbGN1bGF0ZUNvbFNwYW4oXG4gICAgICAgIGFuYWx5dGljc09iamVjdCxcbiAgICAgICAgdGFibGVDb25maWd1cmF0aW9uLmNvbHVtbnMsXG4gICAgICAgIGNvbHVtbkl0ZW1cbiAgICAgICk7XG4gICAgICBjb25zdCBjdXJyZW50Q29sdW1uSXRlbXMgPSBwcmVwYXJlU2luZ2xlQ2F0ZWdvcmllcyhcbiAgICAgICAgYW5hbHl0aWNzT2JqZWN0LFxuICAgICAgICBjb2x1bW5JdGVtXG4gICAgICApO1xuICAgICAgY29uc3QgaGVhZGVySXRlbSA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaW1lbnNpb24uZHVwbGljYXRpb247IGkrKykge1xuICAgICAgICBmb3IgKGNvbnN0IGN1cnJlbnRJdGVtIG9mIGN1cnJlbnRDb2x1bW5JdGVtcykge1xuICAgICAgICAgIGhlYWRlckl0ZW0ucHVzaCh7XG4gICAgICAgICAgICBuYW1lOiBjdXJyZW50SXRlbS5uYW1lLFxuICAgICAgICAgICAgc3BhbjogZGltZW5zaW9uLmNvbF9zcGFuLFxuICAgICAgICAgICAgdHlwZTogY3VycmVudEl0ZW0udHlwZSxcbiAgICAgICAgICAgIGlkOiBjdXJyZW50SXRlbS51aWRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbGV0IHN0eWxlcyA9ICcnO1xuICAgICAgaWYgKHRhYmxlQ29uZmlndXJhdGlvbi5oYXNPd25Qcm9wZXJ0eSgnc3R5bGUnKSkge1xuICAgICAgICBpZiAodGFibGVDb25maWd1cmF0aW9uLnN0eWxlcy5oYXNPd25Qcm9wZXJ0eShjb2x1bW5JdGVtKSkge1xuICAgICAgICAgIHN0eWxlcyA9IHRhYmxlQ29uZmlndXJhdGlvbi5zdHlsZXNbY29sdW1uSXRlbV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRhYmxlLmhlYWRlcnMucHVzaCh7IGl0ZW1zOiBoZWFkZXJJdGVtLCBzdHlsZTogc3R5bGVzIH0pO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IHJvd0l0ZW0gb2YgdGFibGVDb25maWd1cmF0aW9uLnJvd3MpIHtcbiAgICAgIHRhYmxlLmNvbHVtbnMucHVzaChyb3dJdGVtKTtcbiAgICB9XG5cbiAgICAvLyBQcmVwYXJpbmcgdGFibGUgY29sdW1uc1xuICAgIGNvbnN0IGNvbHVtbl9sZW5ndGggPSB0YWJsZUNvbmZpZ3VyYXRpb24uY29sdW1ucy5sZW5ndGg7XG4gICAgY29uc3QgY29sdW1uX2l0ZW1zX2FycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb2x1bW5fbGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGN1cnJlbnRSb3dJdGVtcyA9IHByZXBhcmVTaW5nbGVDYXRlZ29yaWVzKFxuICAgICAgICBhbmFseXRpY3NPYmplY3QsXG4gICAgICAgIHRhYmxlQ29uZmlndXJhdGlvbi5jb2x1bW5zW2ldXG4gICAgICApO1xuICAgICAgY29sdW1uX2l0ZW1zX2FycmF5LnB1c2goY3VycmVudFJvd0l0ZW1zKTtcbiAgICB9XG4gICAgbGV0IHRhYmxlX2NvbHVtbnNfYXJyYXkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbHVtbl9pdGVtc19hcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRhYmxlX2NvbHVtbnNfYXJyYXkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBjb2x1bW5faXRlbXNfYXJyYXlbaV0pIHtcbiAgICAgICAgICB0YWJsZV9jb2x1bW5zX2FycmF5LnB1c2goW2l0ZW1dKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgdGVtcF9hcnIgPSB0YWJsZV9jb2x1bW5zX2FycmF5LmNvbmNhdCgpO1xuICAgICAgICB0YWJsZV9jb2x1bW5zX2FycmF5ID0gW107XG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0ZW1wX2Fycikge1xuICAgICAgICAgIGZvciAoY29uc3QgdmFsIG9mIGNvbHVtbl9pdGVtc19hcnJheVtpXSkge1xuICAgICAgICAgICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICBjb25zdCB0ZW1wQXJyID0gQXJyYXkuZnJvbShpdGVtKTtcbiAgICAgICAgICAgICAgdGFibGVfY29sdW1uc19hcnJheS5wdXNoKHRlbXBBcnIuY29uY2F0KFt2YWxdKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0YWJsZV9jb2x1bW5zX2FycmF5LnB1c2goW2l0ZW0sIHZhbF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFByZXBhcmluZyB0YWJsZSByb3dzXG4gICAgY29uc3Qgcm93c19sZW5ndGggPSB0YWJsZUNvbmZpZ3VyYXRpb24ucm93cy5sZW5ndGg7XG4gICAgY29uc3Qgcm93X2l0ZW1zX2FycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dzX2xlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBkaW1lbnNpb24gPSBjYWxjdWxhdGVDb2xTcGFuKFxuICAgICAgICBhbmFseXRpY3NPYmplY3QsXG4gICAgICAgIHRhYmxlQ29uZmlndXJhdGlvbi5yb3dzLFxuICAgICAgICB0YWJsZUNvbmZpZ3VyYXRpb24ucm93c1tpXVxuICAgICAgKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRSb3dJdGVtcyA9IHByZXBhcmVTaW5nbGVDYXRlZ29yaWVzKFxuICAgICAgICBhbmFseXRpY3NPYmplY3QsXG4gICAgICAgIHRhYmxlQ29uZmlndXJhdGlvbi5yb3dzW2ldXG4gICAgICApO1xuICAgICAgcm93X2l0ZW1zX2FycmF5LnB1c2goeyBpdGVtczogY3VycmVudFJvd0l0ZW1zLCBkaW1lbnNpb25zOiBkaW1lbnNpb24gfSk7XG4gICAgfVxuICAgIGxldCB0YWJsZV9yb3dzX2FycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dfaXRlbXNfYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0YWJsZV9yb3dzX2FycmF5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2Ygcm93X2l0ZW1zX2FycmF5W2ldLml0ZW1zKSB7XG4gICAgICAgICAgaXRlbS5kaW1lbnNpb25zID0gcm93X2l0ZW1zX2FycmF5W2ldLmRpbWVuc2lvbnM7XG4gICAgICAgICAgdGFibGVfcm93c19hcnJheS5wdXNoKFtpdGVtXSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHRlbXBfYXJyID0gdGFibGVfcm93c19hcnJheS5jb25jYXQoKTtcbiAgICAgICAgdGFibGVfcm93c19hcnJheSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGVtcF9hcnIpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHZhbCBvZiByb3dfaXRlbXNfYXJyYXlbaV0uaXRlbXMpIHtcbiAgICAgICAgICAgIHZhbC5kaW1lbnNpb25zID0gcm93X2l0ZW1zX2FycmF5W2ldLmRpbWVuc2lvbnM7XG4gICAgICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgIGNvbnN0IHRlbXBBcnIgPSBBcnJheS5mcm9tKGl0ZW0pO1xuICAgICAgICAgICAgICB0YWJsZV9yb3dzX2FycmF5LnB1c2godGVtcEFyci5jb25jYXQoW3ZhbF0pKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRhYmxlX3Jvd3NfYXJyYXkucHVzaChbaXRlbSwgdmFsXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IGNvdW50ZXIgPSAwO1xuICAgIGlmICh0YWJsZV9yb3dzX2FycmF5Lmxlbmd0aCAhPT0gMCkge1xuICAgICAgZm9yIChjb25zdCByb3dJdGVtIG9mIHRhYmxlX3Jvd3NfYXJyYXkpIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IHtcbiAgICAgICAgICBpdGVtczogW10sXG4gICAgICAgICAgaGVhZGVyczogcm93SXRlbVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKGNvbnN0IHZhbCBvZiByb3dJdGVtKSB7XG4gICAgICAgICAgaWYgKGNvdW50ZXIgPT09IDAgfHwgY291bnRlciAlIHZhbC5kaW1lbnNpb25zLmNvbF9zcGFuID09PSAwKSB7XG4gICAgICAgICAgICBpdGVtLml0ZW1zLnB1c2goe1xuICAgICAgICAgICAgICB0eXBlOiB2YWwudHlwZSxcbiAgICAgICAgICAgICAgbmFtZTogdmFsLnVpZCxcbiAgICAgICAgICAgICAgdmFsOiB2YWwubmFtZSxcbiAgICAgICAgICAgICAgcm93X3NwYW46IHZhbC5kaW1lbnNpb25zLmNvbF9zcGFuLFxuICAgICAgICAgICAgICBoZWFkZXI6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGNvbEl0ZW0gb2YgdGFibGVfY29sdW1uc19hcnJheSkge1xuICAgICAgICAgIGNvbnN0IGRhdGFJdGVtID0gW107XG4gICAgICAgICAgZm9yIChjb25zdCB2YWwgb2Ygcm93SXRlbSkge1xuICAgICAgICAgICAgZGF0YUl0ZW0ucHVzaCh7IHR5cGU6IHZhbC50eXBlLCB2YWx1ZTogdmFsLnVpZCB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yIChjb25zdCB2YWwgb2YgY29sSXRlbSkge1xuICAgICAgICAgICAgZGF0YUl0ZW0ucHVzaCh7IHR5cGU6IHZhbC50eXBlLCB2YWx1ZTogdmFsLnVpZCB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaXRlbS5pdGVtcy5wdXNoKHtcbiAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgdmFsOiBnZXREYXRhVmFsdWUoYW5hbHl0aWNzT2JqZWN0LCBkYXRhSXRlbSksXG4gICAgICAgICAgICBjb2xvcjogZ2V0RGF0YVZhbHVlQ29sb3IoXG4gICAgICAgICAgICAgIGxlZ2VuZENsYXNzZXMsXG4gICAgICAgICAgICAgIGdldERhdGFWYWx1ZShhbmFseXRpY3NPYmplY3QsIGRhdGFJdGVtKVxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHJvd19zcGFuOiAnMScsXG4gICAgICAgICAgICBkaXNwbGF5OiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFxuICAgICAgICAgIHRhYmxlQ29uZmlndXJhdGlvbi5oYXNPd25Qcm9wZXJ0eSgnaGlkZUVtcHR5Um93cycpICYmXG4gICAgICAgICAgdGFibGVDb25maWd1cmF0aW9uLmhpZGVFbXB0eVJvd3NcbiAgICAgICAgKSB7XG4gICAgICAgICAgaWYgKCFjaGVja1plcm9zKHRhYmxlQ29uZmlndXJhdGlvbi5yb3dzLmxlbmd0aCwgaXRlbS5pdGVtcykpIHtcbiAgICAgICAgICAgIHRhYmxlLnJvd3MucHVzaChpdGVtKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGFibGUucm93cy5wdXNoKGl0ZW0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY291bnRlcisrO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBpdGVtID0ge1xuICAgICAgICBpdGVtczogW10sXG4gICAgICAgIGhlYWRlcnM6IFtdXG4gICAgICB9O1xuICAgICAgZm9yIChjb25zdCBjb2xJdGVtIG9mIHRhYmxlX2NvbHVtbnNfYXJyYXkpIHtcbiAgICAgICAgY29uc3QgZGF0YUl0ZW0gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCB2YWwgb2YgY29sSXRlbSkge1xuICAgICAgICAgIGRhdGFJdGVtLnB1c2goeyB0eXBlOiB2YWwudHlwZSwgdmFsdWU6IHZhbC51aWQgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaXRlbS5pdGVtcy5wdXNoKHtcbiAgICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgICB2YWw6IGdldERhdGFWYWx1ZShhbmFseXRpY3NPYmplY3QsIGRhdGFJdGVtKSxcbiAgICAgICAgICByb3dfc3BhbjogJzEnLFxuICAgICAgICAgIGRpc3BsYXk6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoXG4gICAgICAgIHRhYmxlQ29uZmlndXJhdGlvbi5oYXNPd25Qcm9wZXJ0eSgnaGlkZUVtcHR5Um93cycpICYmXG4gICAgICAgIHRhYmxlQ29uZmlndXJhdGlvbi5oaWRlRW1wdHlSb3dzXG4gICAgICApIHtcbiAgICAgICAgaWYgKCFjaGVja1plcm9zKHRhYmxlQ29uZmlndXJhdGlvbi5yb3dzLmxlbmd0aCwgaXRlbS5pdGVtcykpIHtcbiAgICAgICAgICB0YWJsZS5yb3dzLnB1c2goaXRlbSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRhYmxlLnJvd3MucHVzaChpdGVtKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyB0b2RvIGltcHJvdmUgdG90YWwgb3B0aW9ucyB0byBhbHNvIHdvcmsgZm9yIGV2ZW50IHRhYmxlXG4gIC8vIHJldHVybiBfZ2V0U2FuaXRpemVkVGFibGVPYmplY3QodGFibGUsIHRhYmxlQ29uZmlndXJhdGlvbik7XG4gIHJldHVybiB0YWJsZTtcbn1cblxuZnVuY3Rpb24gZ2V0VGl0bGVJbmRleChhbmFseXRpY3NPYmplY3RIZWFkZXJzLCBuYW1lOiBzdHJpbmcpIHtcbiAgbGV0IGluZGV4ID0gMDtcbiAgbGV0IGNvdW50ZXIgPSAwO1xuICBmb3IgKGNvbnN0IGhlYWRlciBvZiBhbmFseXRpY3NPYmplY3RIZWFkZXJzKSB7XG4gICAgaWYgKGhlYWRlci5uYW1lID09PSBuYW1lKSB7XG4gICAgICBpbmRleCA9IGNvdW50ZXI7XG4gICAgfVxuICAgIGNvdW50ZXIrKztcbiAgfVxuICByZXR1cm4gaW5kZXg7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZUNvbFNwYW4oYW5hbHl0aWNzT2JqZWN0LCBhcnJheSwgaXRlbSkge1xuICBjb25zdCBpbmRleE9mSXRlbSA9IGFycmF5LmluZGV4T2YoaXRlbSk7XG4gIGNvbnN0IGFycmF5X2xlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgY29uc3QgbGFzdF9pbmRleCA9IGFycmF5X2xlbmd0aCAtIDE7XG4gIGNvbnN0IGRpbWVuc2lvbnMgPSB7IGNvbF9zcGFuOiAxLCBkdXBsaWNhdGlvbjogMSB9O1xuICBmb3IgKGxldCBpID0gbGFzdF9pbmRleDsgaSA+IGluZGV4T2ZJdGVtOyBpLS0pIHtcbiAgICBjb25zdCBhcnIgPSBwcmVwYXJlU2luZ2xlQ2F0ZWdvcmllcyhhbmFseXRpY3NPYmplY3QsIGFycmF5W2ldKTtcbiAgICBkaW1lbnNpb25zLmNvbF9zcGFuID0gZGltZW5zaW9ucy5jb2xfc3BhbiAqIGFyci5sZW5ndGg7XG4gIH1cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbmRleE9mSXRlbTsgaSsrKSB7XG4gICAgY29uc3QgYXJyID0gcHJlcGFyZVNpbmdsZUNhdGVnb3JpZXMoYW5hbHl0aWNzT2JqZWN0LCBhcnJheVtpXSk7XG4gICAgZGltZW5zaW9ucy5kdXBsaWNhdGlvbiA9IGRpbWVuc2lvbnMuZHVwbGljYXRpb24gKiBhcnIubGVuZ3RoO1xuICB9XG4gIHJldHVybiBkaW1lbnNpb25zO1xufVxuXG5mdW5jdGlvbiBwcmVwYXJlU2luZ2xlQ2F0ZWdvcmllcyhcbiAgaW5pdGlhbEFuYWx5dGljcyxcbiAgaXRlbUlkZW50aWZpZXIsXG4gIHByZURlZmluZWRJdGVtcyA9IFtdXG4pIHtcbiAgY29uc3QgYW5hbHl0aWNzT2JqZWN0ID0gc2FuaXRpemVJbmNvbWluZ0FuYWx5dGljcyhpbml0aWFsQW5hbHl0aWNzKTtcbiAgY29uc3Qgc3RydWN0dXJlID0gW107XG4gIGlmIChwcmVEZWZpbmVkSXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgZm9yIChjb25zdCB2YWwgb2YgZ2V0TWV0YWRhdGFBcnJheShhbmFseXRpY3NPYmplY3QsIGl0ZW1JZGVudGlmaWVyKSkge1xuICAgICAgc3RydWN0dXJlLnB1c2goe1xuICAgICAgICBuYW1lOiBhbmFseXRpY3NPYmplY3QubWV0YURhdGEubmFtZXNbdmFsXSxcbiAgICAgICAgdWlkOiB2YWwsXG4gICAgICAgIHR5cGU6IGl0ZW1JZGVudGlmaWVyXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgaWYgKHByZURlZmluZWRJdGVtcy5sZW5ndGggIT09IDApIHtcbiAgICBmb3IgKGNvbnN0IHZhbCBvZiBwcmVEZWZpbmVkSXRlbXMpIHtcbiAgICAgIHN0cnVjdHVyZS5wdXNoKHtcbiAgICAgICAgbmFtZTogYW5hbHl0aWNzT2JqZWN0Lm1ldGFEYXRhLm5hbWVzW3ZhbF0sXG4gICAgICAgIHVpZDogdmFsLFxuICAgICAgICB0eXBlOiBpdGVtSWRlbnRpZmllclxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBzdHJ1Y3R1cmU7XG59XG5cbmZ1bmN0aW9uIHNhbml0aXplSW5jb21pbmdBbmFseXRpY3MoYW5hbHl0aWNzT2JqZWN0OiBhbnkpIHtcbiAgcmV0dXJuIGFuYWx5dGljc09iamVjdDtcbn1cblxuZnVuY3Rpb24gZ2V0TWV0YWRhdGFBcnJheShhbmFseXRpY3NPYmplY3QsIG1ldGFkYXRhVHlwZTogc3RyaW5nKSB7XG4gIGxldCBtZXRhZGF0YUFycmF5ID0gW107XG4gIGlmIChtZXRhZGF0YVR5cGUgPT09ICdkeCcpIHtcbiAgICBtZXRhZGF0YUFycmF5ID0gYW5hbHl0aWNzT2JqZWN0Lm1ldGFEYXRhLmR4O1xuICB9IGVsc2UgaWYgKG1ldGFkYXRhVHlwZSA9PT0gJ291Jykge1xuICAgIG1ldGFkYXRhQXJyYXkgPSBhbmFseXRpY3NPYmplY3QubWV0YURhdGEub3U7XG4gIH0gZWxzZSBpZiAobWV0YWRhdGFUeXBlID09PSAnY28nKSB7XG4gICAgbWV0YWRhdGFBcnJheSA9IGFuYWx5dGljc09iamVjdC5tZXRhRGF0YS5jbztcbiAgfSBlbHNlIGlmIChtZXRhZGF0YVR5cGUgPT09ICdwZScpIHtcbiAgICBtZXRhZGF0YUFycmF5ID0gYW5hbHl0aWNzT2JqZWN0Lm1ldGFEYXRhLnBlO1xuICB9IGVsc2Uge1xuICAgIG1ldGFkYXRhQXJyYXkgPSBhbmFseXRpY3NPYmplY3QubWV0YURhdGFbbWV0YWRhdGFUeXBlXTtcbiAgfVxuICByZXR1cm4gbWV0YWRhdGFBcnJheTtcbn1cblxuZnVuY3Rpb24gZ2V0RGF0YVZhbHVlKGFuYWx5dGljc09iamVjdCwgZGF0YUl0ZW1zID0gW10pIHtcbiAgbGV0IG51bSA9IG51bGw7XG4gIGZvciAoY29uc3QgdmFsdWUgb2YgYW5hbHl0aWNzT2JqZWN0LnJvd3MpIHtcbiAgICBsZXQgY291bnRlciA9IDA7XG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGRhdGFJdGVtcykge1xuICAgICAgaWYgKFxuICAgICAgICB2YWx1ZVtnZXRUaXRsZUluZGV4KGFuYWx5dGljc09iamVjdC5oZWFkZXJzLCBpdGVtLnR5cGUpXSA9PT0gaXRlbS52YWx1ZVxuICAgICAgKSB7XG4gICAgICAgIGNvdW50ZXIrKztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGNvdW50ZXIgPT09IGRhdGFJdGVtcy5sZW5ndGgpIHtcbiAgICAgIGlmIChpc05hTih2YWx1ZVtnZXRUaXRsZUluZGV4KGFuYWx5dGljc09iamVjdC5oZWFkZXJzLCAndmFsdWUnKV0pKSB7XG4gICAgICAgIG51bSA9IHZhbHVlW2dldFRpdGxlSW5kZXgoYW5hbHl0aWNzT2JqZWN0LmhlYWRlcnMsICd2YWx1ZScpXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG51bSArPSBwYXJzZUZsb2F0KFxuICAgICAgICAgIHZhbHVlW2dldFRpdGxlSW5kZXgoYW5hbHl0aWNzT2JqZWN0LmhlYWRlcnMsICd2YWx1ZScpXVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbnVtO1xufVxuXG5mdW5jdGlvbiBnZXREYXRhVmFsdWVDb2xvcihsZWdlbmRDbGFzc2VzLCB2YWx1ZSkge1xuICBsZXQgY29sb3IgPSAnJztcbiAgaWYgKCFpc05hTih2YWx1ZSkgJiYgbGVnZW5kQ2xhc3Nlcykge1xuICAgIGxlZ2VuZENsYXNzZXMuZm9yRWFjaChsZWdlbmRDbGFzcyA9PiB7XG4gICAgICBpZiAobGVnZW5kQ2xhc3Muc3RhcnRWYWx1ZSA8PSB2YWx1ZSAmJiBsZWdlbmRDbGFzcy5lbmRWYWx1ZSA+IHZhbHVlKSB7XG4gICAgICAgIGNvbG9yID0gbGVnZW5kQ2xhc3MuY29sb3I7XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIChsZWdlbmRDbGFzcy5zdGFydFZhbHVlIDwgdmFsdWUgJiYgbGVnZW5kQ2xhc3MuZW5kVmFsdWUgPj0gdmFsdWUpIHtcbiAgICAgIFxuICAgICAgLy8gfVxuICAgIH0pO1xuICB9XG4gIHJldHVybiBjb2xvcjtcbn1cblxuZnVuY3Rpb24gY2hlY2taZXJvcyhzdGF0aW5nX2xlbmd0aCwgYXJyYXkpOiBib29sZWFuIHtcbiAgbGV0IGNoZWNrZXIgPSB0cnVlO1xuICBmb3IgKGxldCBpID0gc3RhdGluZ19sZW5ndGg7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChhcnJheVtpXS5uYW1lID09PSAnJyAmJiBhcnJheVtpXS52YWwgIT0gbnVsbCkge1xuICAgICAgY2hlY2tlciA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY2hlY2tlcjtcbn1cbiJdfQ==