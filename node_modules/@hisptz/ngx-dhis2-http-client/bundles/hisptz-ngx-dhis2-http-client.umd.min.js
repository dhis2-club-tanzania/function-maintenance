!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs"),require("rxjs/internal/operators")):"function"==typeof define&&define.amd?define("@hisptz/ngx-dhis2-http-client",["exports","@angular/core","@angular/common/http","rxjs","rxjs/internal/operators"],e):e((t.hisptz=t.hisptz||{},t.hisptz["ngx-dhis2-http-client"]={}),t.ng.core,t.ng.common.http,t.rxjs,t.rxjs["internal/operators"])}(this,function(t,e,r,n,a){"use strict";var i=function(){function t(t){this.httpClient=t,this._defaultRootUrl="../../../",this._manifestLoaded=!1}return t.prototype.getManifest=function(){var e=this;return this._manifestLoaded?n.of(this._manifest):this.httpClient.get("manifest.webapp").pipe(a.catchError(function(){return console.warn("Manifest file could not be loaded, default options have been used instead"),n.of(null)}),a.tap(function(t){e._manifest=t,e._manifestLoaded=!0}))},t.prototype.getRootUrl=function(){var e=this;return this.getManifest().pipe(a.map(function(t){return t&&t.activities&&t.activities.dhis&&t.activities.dhis.href?t.activities.dhis.href:e._defaultRootUrl}))},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient}]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t(e.inject(r.HttpClient))},token:t,providedIn:"root"}),t}(),o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s=function(){function t(t,e){this.manifestService=t,this.httpClient=e,this._systemInfoLoaded=!1}return t.prototype.getSystemInfo=function(){var e=this;return this._systemInfoLoaded?n.of(this._systemInfo):this.manifestService.getRootUrl().pipe(a.switchMap(function(t){return n.forkJoin(e.httpClient.get(t+"api/system/info"),e.httpClient.get(t+"api/systemSettings")).pipe(a.map(function(t){return o({},t[0],t[1])}),a.tap(function(t){e._systemInfo=t,e._systemInfoLoaded=!0}))}))},t.prototype.getSystemVersion=function(){return this.getSystemInfo().pipe(a.map(function(t){if(!t)return 0;var e=t.version?t.version.split("."):[];return parseInt(e[1],10)||0}))},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:i},{type:r.HttpClient}]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t(e.inject(i),e.inject(r.HttpClient))},token:t,providedIn:"root"}),t}(),p=function(){function t(t,e,r){this.httpClient=t,this.manifestService=e,this.systemInfoService=r}return t.prototype.get=function(e,t,r,n){var i=this;return void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===n&&(n=!1),(n?this.manifestService.getRootUrl():this._getApiRootUrl(t,r)).pipe(a.mergeMap(function(t){return i.httpClient.get(t+e).pipe(a.catchError(i._handleError))}),a.catchError(this._handleError))},t.prototype.post=function(e,r,t,n,i,o){var s=this;return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),(i?this.manifestService.getRootUrl():this._getApiRootUrl(t,n)).pipe(a.mergeMap(function(t){return s.httpClient.post(t+e,r).pipe(a.catchError(s._handleError))}),a.catchError(this._handleError))},t.prototype.put=function(e,r,t,n,i){var o=this;return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),(i?this.manifestService.getRootUrl():this._getApiRootUrl(t,n)).pipe(a.mergeMap(function(t){return o.httpClient.put(t+e,r).pipe(a.catchError(o._handleError))}),a.catchError(this._handleError))},t.prototype["delete"]=function(e,t,r,n){var i=this;return void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===n&&(n=!1),(n?this.manifestService.getRootUrl():this._getApiRootUrl(t,r)).pipe(a.mergeMap(function(t){return i.httpClient["delete"](t+e).pipe(a.catchError(i._handleError))}),a.catchError(this._handleError))},t.prototype._handleError=function(t){var e=null;return e=t.error instanceof ErrorEvent?{message:t.error,status:t.status,statusText:t.statusText}:{message:t.error instanceof Object?t.error.message:t.error||t.message,status:t.status,statusText:t.statusText},n.throwError(e)},t.prototype._getApiRootUrl=function(e,r){var t=this;return void 0===e&&(e=!1),void 0===r&&(r=!1),this.manifestService.getRootUrl().pipe(a.switchMap(function(e){return t.systemInfoService.getSystemVersion().pipe(a.map(function(t){return{rootUrl:e,version:t-1<=25?t+1:t}}))})).pipe(a.map(function(t){return t.rootUrl+"api/"+(e&&!r?t.version+"/":r&&t.version?t.version-1+"/":"")}))},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient},{type:i},{type:s}]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t(e.inject(r.HttpClient),e.inject(i),e.inject(s))},token:t,providedIn:"root"}),t}(),c=[i,s,p];t.services=c,t.ManifestService=i,t.SystemInfoService=s,t.NgxDhis2HttpClientService=p,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=hisptz-ngx-dhis2-http-client.umd.min.js.map